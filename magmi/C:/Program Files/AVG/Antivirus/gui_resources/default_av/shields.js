//{"name":"shields","version":"1.2.1298","created":"2023-07-13T10:35:45.654Z"}
import{SvelteComponent as e,init as t,safe_not_equal as n,space as i,empty as l,insert as a,group_outros as s,transition_out as o,check_outros as c,transition_in as r,detach as d,component_subscribe as p,element as u,attr as h,set_custom_element_data as b,listen as m,noop as g,create_slot as f,update_slot_base as S,get_all_dirty_from_scope as v,get_slot_changes as $,text as y,append as k,set_data as w,assign as I,set_attributes as A,toggle_class as C,is_function as x,get_spread_update as T,run_all as E,create_component as P,mount_component as _,destroy_component as D,append_styles as O,prevent_default as F,update_keyed_each as N,destroy_block as R,handle_promise as W,update_await_block_branch as j,binding_callbacks as B,bind as M,add_flush_callback as V,action_destroyer as L}from"./svelteInternal.js";import{nls as K,format as U}from"./i18n.js";import{eventer as H,burgerTracker as z,serviceRequest as G,moduleManager as X,EventEmitter as q,windowApi as Y}from"./napi.js";import{productModel as J,ipmService as Q,settingsService as Z,napiUtils as ee}from"./napiExtensions.js";import{featureManager as te,Modal as ne,Tabs as ie,modals as le,DetectionDialog as ae}from"./svelteComponents.js";import{components as se}from"./settings.js";import{stringUtils as oe}from"./libs.js";import{onMount as ce}from"./svelteInternal.js";const re={title:"shields.behavior",desc:"shields.behavior.desc",enableBehaviorShield:"shields.settings.enableBehaviorShield"};function de(){return Promise.resolve({value:J.isEnabled("BehaviorShield"),locked:!1})}function pe(){const e={title:K("shields.behavior.stopOptions.title"),desc:K("shields.behavior.stopOptions.desc")};return te.toggle("BehaviorShield",{stopOptions:e})}function ue(){return{enableShield:{id:"stg-shield-behavior-checkbox",label:K(re.enableBehaviorShield),load:de,change:pe,path:"behaviorShield",search:re.enableBehaviorShield}}}const he={file:"FileSystemShield",web:"WebShield",email:"EmailShield",behavior:"BehaviorShield",antiRootkit:"AntiRootkit",antiExploit:"AntiExploit"},be={installed:"installed",notInstalled:"notInstalled",installing:"installing",error:"error"};function me(e){return e===he.file?{title:K("shields.fsh.stopOptions.title"),desc:K("shields.fsh.stopOptions.desc")}:e===he.web?{title:K("shields.web.stopOptions.title"),desc:K("shields.web.stopOptions.desc")}:e===he.email?{title:K("shields.email.stopOptions.title"),desc:K("shields.email.stopOptions.desc")}:e===he.behavior?{title:K("shields.behavior.stopOptions.title"),desc:K("shields.behavior.stopOptions.desc")}:{title:K("shields.turnOffShield"),desc:K("shields.turnOffShield.desc")}}function ge(){}function fe(e){return e()}function Se(e,...t){if(null==e)return ge;const n=e.subscribe(...t);return n.unsubscribe?()=>n.unsubscribe():n}Promise.resolve();const ve=[];function $e(e,t=ge){let n;const i=new Set;function l(t){if(a=t,((l=e)!=l?a==a:l!==a||l&&"object"==typeof l||"function"==typeof l)&&(e=t,n)){const t=!ve.length;for(const n of i)n[1](),ve.push(n,e);if(t){for(let e=0;e<ve.length;e+=2)ve[e][0](ve[e+1]);ve.length=0}}var l,a}return{set:l,update:function(t){l(t(e))},subscribe:function(a,s=ge){const o=[a,s];return i.add(o),1===i.size&&(n=t(l)||ge),a(e),()=>{i.delete(o),0===i.size&&(n(),n=null)}}}}function ye(e,t,n){const i=!Array.isArray(e),l=i?[e]:e,a=t.length<2;return s=e=>{let n=!1;const s=[];let o=0,c=ge;const r=()=>{if(o)return;c();const n=t(i?s[0]:s,e);a?e(n):c="function"==typeof n?n:ge},d=l.map(((e,t)=>Se(e,(e=>{s[t]=e,o&=~(1<<t),n&&r()}),(()=>{o|=1<<t}))));return n=!0,r(),function(){d.forEach(fe),c()}},{subscribe:$e(n,s).subscribe};var s}class ke{constructor(e){this.shieldKey=e,this.featureId=he[e],this.shield=$e({active:J.isEnabled(this.featureId),licensed:J.isLicensed(this.featureId),installStatus:J.isInstalled(this.featureId)?be.installed:be.notInstalled}),this.listeners=[],this.onInit()}getShield(){return ye(this.shield,(e=>e))}updateShield(e,t){this.shield.update((n=>({...n,[e]:t})))}onInit(){this.installer=J.getInstaller(this.featureId),this.installer.isInProgress().then((e=>{e&&this.observeInstalling()})),this.listeners.push(H.on(`product.change.feature.${this.featureId}.enabled`,(e=>{this.updateShield("active",e)}))),this.listeners.push(H.on(`product.change.feature.${this.featureId}.licensed`,(e=>{this.updateShield("licensed",e)}))),this.isSettings=window.location.hash.includes("#settings/")}onDestroy(){this.installer&&this.installer.close(),this.listeners.forEach((e=>e())),this.listeners=null}observeInstalling(){this.updateShield("installStatus",be.installing),this.installer.on("progress",(e=>this.updateShield("installProgress",e))),this.installer.on("done",(()=>{this.installer.isInstalled().then((e=>{this.updateShield("installStatus",e?be.installed:be.error),this.installer.close()}))}))}installShield(){this.installer.install(),this.observeInstalling()}toggleShield(){if(!function(e){let t;return Se(e,(e=>t=e))(),t}(this.shield).licensed)return Q.openWindow(343,{p_scr:`shields_${this.shieldKey}`});this.updateShield("controllable",!1);const e=me(this.featureId);return te.toggle(this.featureId,{stopOptions:e,track:({enabled:e,time:t})=>{this.isSettings?H.emit("Settings.gaTrack","Enable "+this.shieldKey+" shield",e?"on":"off",t):z.feature.toggle({enabled:e,time:t,feature:this.featureId,view:"shields"})}}).then((e=>this.updateShield("active",e))).finally((()=>this.updateShield("controllable",!0)))}}function we(e){let t,n,i;return{c(){t=u("kin-button"),t.textContent=`${K("shields.installShield")}`,b(t,"type","secondary"),b(t,"size","small"),b(t,"class","g-margin-bottom--10")},m(l,s){a(l,t,s),n||(i=m(t,"click",e[17]),n=!0)},p:g,i:g,o:g,d(e){e&&d(t),n=!1,i()}}}function Ie(e){let t,n,l;return{c(){t=u("kin-progress"),n=i(),l=u("p"),l.textContent=`${K("shields.installingShield")}`,b(t,"percentage","unknown"),b(t,"csscls","-standalone shl_progress  g-margin-bottom--25 g-margin-top--20"),h(l,"class","p -secondary -small")},m(e,i){a(e,t,i),a(e,n,i),a(e,l,i)},p:g,i:g,o:g,d(e){e&&d(t),e&&d(n),e&&d(l)}}}function Ae(e){let t,n,l,p;const u=[xe,Ce],h=[];function b(e,t){return e[0]?1:0}t=b(e),n=h[t]=u[t](e);const m=e[13].default,g=f(m,e,e[12],null);return{c(){n.c(),l=i(),g&&g.c()},m(e,n){h[t].m(e,n),a(e,l,n),g&&g.m(e,n),p=!0},p(e,i){let a=t;t=b(e),t===a?h[t].p(e,i):(s(),o(h[a],1,1,(()=>{h[a]=null})),c(),n=h[t],n?n.p(e,i):(n=h[t]=u[t](e),n.c()),r(n,1),n.m(l.parentNode,l)),g&&g.p&&(!p||4096&i)&&S(g,m,e,e[12],p?$(m,e[12],i,null):v(e[12]),null)},i(e){p||(r(n),r(g,e),p=!0)},o(e){o(n),o(g,e),p=!1},d(e){h[t].d(e),e&&d(l),g&&g.d(e)}}}function Ce(e){let t,n,i=K(e[1])+"";return{c(){t=u("p"),n=y(i),h(t,"class","settings__desc")},m(e,i){a(e,t,i),k(t,n)},p(e,t){2&t&&i!==(i=K(e[1])+"")&&w(n,i)},i:g,o:g,d(e){e&&d(t)}}}function xe(e){let t,l,s,c,r,p,b=e[3].licensed?"div":"button",m=K(e[1])+"",f=(e[3].licensed?"div":"button")&&Ee(e);return{c(){t=u("div"),f&&f.c(),l=i(),s=u("p"),c=y(m),h(s,"class","settings__indent checkbox__desc"),h(t,"class","settings__row"),h(t,"id",r=e[6]+"__container")},m(e,n){a(e,t,n),f&&f.m(t,null),k(t,l),k(t,s),k(s,c)},p(e,i){e[3].licensed||"button"?b?n(b,e[3].licensed?"div":"button")?(f.d(1),f=Ee(e),f.c(),f.m(t,l)):f.p(e,i):(f=Ee(e),f.c(),f.m(t,l)):b&&(f.d(1),f=null),b=e[3].licensed?"div":"button",(!p||2&i)&&m!==(m=K(e[1])+"")&&w(c,m),(!p||64&i&&r!==(r=e[6]+"__container"))&&h(t,"id",r)},i:g,o(e){o(f),p=!1},d(e){e&&d(t),f&&f.d(e)}}}function Te(e){let t,n;return t=new e[10]({props:{icon:"icon-s-fill-lock",premium:!0}}),{c(){P(t.$$.fragment)},m(e,i){_(t,e,i),n=!0},i(e){n||(r(t.$$.fragment,e),n=!0)},o(e){o(t.$$.fragment,e),n=!1},d(e){D(t,e)}}}function Ee(e){let t,n,l,p,b,g,f,S,v,$,P,_,D,O,F=e[2].label+"",N=!e[3].licensed&&Te(e),R=[{"aria-label":$=e[3].licensed?void 0:`${K("settings.unlicensed")} ${e[2].label}`},{class:P="checkbox__row "+(e[5]&&e[3].licensed?"":"-disabled")}],W={};for(let i=0;i<R.length;i+=1)W=I(W,R[i]);return{c(){t=u(e[3].licensed?"div":"button"),n=u("input"),b=i(),g=u("label"),f=y(F),S=i(),N&&N.c(),h(n,"decorator","registerInput"),h(n,"type","checkbox"),n.disabled=l=!e[5],h(n,"id",e[6]),h(n,"class",p="checkbox "+(e[5]&&e[3].licensed?"":"-disabled")),h(g,"class",v="checkbox__label "+(e[5]&&e[3].licensed?"":"-disabled")),h(g,"for",e[6]),A(t,W),C(t,"checkbox__row__button",!e[3].licensed)},m(i,l){a(i,t,l),k(t,n),n.checked=e[4],k(t,b),k(t,g),k(g,f),k(g,S),N&&N.m(g,null),_=!0,D||(O=[m(n,"change",e[14]),m(n,"change",e[15]),m(t,"click",(function(){x(e[3].licensed?void 0:e[16])&&(e[3].licensed?void 0:e[16]).apply(this,arguments)}))],D=!0)},p(i,a){e=i,(!_||32&a&&l!==(l=!e[5]))&&(n.disabled=l),(!_||64&a)&&h(n,"id",e[6]),(!_||40&a&&p!==(p="checkbox "+(e[5]&&e[3].licensed?"":"-disabled")))&&h(n,"class",p),16&a&&(n.checked=e[4]),(!_||4&a)&&F!==(F=e[2].label+"")&&w(f,F),e[3].licensed?N&&(s(),o(N,1,1,(()=>{N=null})),c()):N?8&a&&r(N,1):(N=Te(e),N.c(),r(N,1),N.m(g,null)),(!_||40&a&&v!==(v="checkbox__label "+(e[5]&&e[3].licensed?"":"-disabled")))&&h(g,"class",v),(!_||64&a)&&h(g,"for",e[6]),A(t,W=T(R,[(!_||12&a&&$!==($=e[3].licensed?void 0:`${K("settings.unlicensed")} ${e[2].label}`))&&{"aria-label":$},(!_||40&a&&P!==(P="checkbox__row "+(e[5]&&e[3].licensed?"":"-disabled")))&&{class:P}])),C(t,"checkbox__row__button",!e[3].licensed)},i(e){_||(r(N),_=!0)},o(e){o(N),_=!1},d(e){e&&d(t),N&&N.d(),D=!1,E(O)}}}function Pe(e){let t;let n=function(e,t){return e[7]?De:_e}(e),i=n(e);return{c(){t=u("p"),i.c(),h(t,"class","p -secondary -small g-margin-top--10")},m(e,n){a(e,t,n),i.m(t,null)},p(e,t){i.p(e,t)},d(e){e&&d(t),i.d()}}}function _e(e){let t,n=K("shields.notInstalledWarning")+"";return{c(){t=y(n)},m(e,n){a(e,t,n)},p:g,d(e){e&&d(t)}}}function De(e){let t,n=K("shields.disabledByAdmin")+"";return{c(){t=y(n)},m(e,n){a(e,t,n)},p:g,d(e){e&&d(t)}}}function Oe(e){let t,n,p,u,h;const b=[Ae,Ie,we],m=[];function g(e,t){return e[3].installStatus===be.installed?0:e[3].installStatus===be.installing?1:e[7]?-1:2}~(t=g(e))&&(n=m[t]=b[t](e));let f=e[3].installStatus===be.notInstalled&&Pe(e);return{c(){n&&n.c(),p=i(),f&&f.c(),u=l()},m(e,n){~t&&m[t].m(e,n),a(e,p,n),f&&f.m(e,n),a(e,u,n),h=!0},p(e,[i]){let l=t;t=g(e),t===l?~t&&m[t].p(e,i):(n&&(s(),o(m[l],1,1,(()=>{m[l]=null})),c()),~t?(n=m[t],n?n.p(e,i):(n=m[t]=b[t](e),n.c()),r(n,1),n.m(p.parentNode,p)):n=null),e[3].installStatus===be.notInstalled?f?f.p(e,i):(f=Pe(e),f.c(),f.m(u.parentNode,u)):f&&(f.d(1),f=null)},i(e){h||(r(n),h=!0)},o(e){o(n),h=!1},d(e){~t&&m[t].d(e),e&&d(p),f&&f.d(e),e&&d(u)}}}function Fe(e,t,n){let i,l,a,s,{$$slots:o={},$$scope:c}=t,{standalone:r=!1}=t,{shieldKey:d}=t,{desc:u}=t,{enableShield:h={}}=t;const b=J.isAfbManaged(),m=new ke(d),g=m.getShield();p(e,g,(e=>n(3,s=e)));const{Badge:f}=se;return e.$$set=e=>{"standalone"in e&&n(0,r=e.standalone),"shieldKey"in e&&n(11,d=e.shieldKey),"desc"in e&&n(1,u=e.desc),"enableShield"in e&&n(2,h=e.enableShield),"$$scope"in e&&n(12,c=e.$$scope)},e.$$.update=()=>{2052&e.$$.dirty&&n(6,i=h.id||`stg-shield-${d}-checkbox`),8&e.$$.dirty&&n(5,l=!b&&s.installStatus===be.installed),8&e.$$.dirty&&n(4,a=s.active)},[r,u,h,s,a,l,i,b,m,g,f,d,c,o,function(){a=this.checked,n(4,a),n(3,s)},()=>m.toggleShield(),()=>m.toggleShield(),()=>m.installShield()]}class Ne extends e{constructor(e){super(),t(this,e,Fe,Oe,n,{standalone:0,shieldKey:11,desc:1,enableShield:2})}}function Re(e){let t,n;return t=new Ne({props:{shieldKey:e[1],standalone:e[0],desc:e[3],enableShield:e[4],$$slots:{default:[je]},$$scope:{ctx:e}}}),{c(){P(t.$$.fragment)},m(e,i){_(t,e,i),n=!0},p(e,n){const i={};2&n&&(i.shieldKey=e[1]),1&n&&(i.standalone=e[0]),8&n&&(i.desc=e[3]),16&n&&(i.enableShield=e[4]),512&n&&(i.$$scope={dirty:n,ctx:e}),t.$set(i)},i(e){n||(r(t.$$.fragment,e),n=!0)},o(e){o(t.$$.fragment,e),n=!1},d(e){D(t,e)}}}function We(e){let t,n;return t=new e[7]({props:{title:K(e[2]),component:e[5],stopOptions:e[6],noLicense:"true",$$slots:{default:[Me]},$$scope:{ctx:e}}}),{c(){P(t.$$.fragment)},m(e,i){_(t,e,i),n=!0},p(e,n){const i={};4&n&&(i.title=K(e[2])),539&n&&(i.$$scope={dirty:n,ctx:e}),t.$set(i)},i(e){n||(r(t.$$.fragment,e),n=!0)},o(e){o(t.$$.fragment,e),n=!1},d(e){D(t,e)}}}function je(e){let t;const n=e[8].default,i=f(n,e,e[9],null);return{c(){i&&i.c()},m(e,n){i&&i.m(e,n),t=!0},p(e,l){i&&i.p&&(!t||512&l)&&S(i,n,e,e[9],t?$(n,e[9],l,null):v(e[9]),null)},i(e){t||(r(i,e),t=!0)},o(e){o(i,e),t=!1},d(e){i&&i.d(e)}}}function Be(e){let t;const n=e[8].default,i=f(n,e,e[9],null);return{c(){i&&i.c()},m(e,n){i&&i.m(e,n),t=!0},p(e,l){i&&i.p&&(!t||512&l)&&S(i,n,e,e[9],t?$(n,e[9],l,null):v(e[9]),null)},i(e){t||(r(i,e),t=!0)},o(e){o(i,e),t=!1},d(e){i&&i.d(e)}}}function Me(e){let t,n;return t=new Ne({props:{shieldKey:e[1],standalone:e[0],desc:e[3],enableShield:e[4],$$slots:{default:[Be]},$$scope:{ctx:e}}}),{c(){P(t.$$.fragment)},m(e,i){_(t,e,i),n=!0},p(e,n){const i={};2&n&&(i.shieldKey=e[1]),1&n&&(i.standalone=e[0]),8&n&&(i.desc=e[3]),16&n&&(i.enableShield=e[4]),512&n&&(i.$$scope={dirty:n,ctx:e}),t.$set(i)},i(e){n||(r(t.$$.fragment,e),n=!0)},o(e){o(t.$$.fragment,e),n=!1},d(e){D(t,e)}}}function Ve(e){let t,n,i,p;const u=[We,Re],h=[];function b(e,t){return e[0]?0:1}return t=b(e),n=h[t]=u[t](e),{c(){n.c(),i=l()},m(e,n){h[t].m(e,n),a(e,i,n),p=!0},p(e,[l]){let a=t;t=b(e),t===a?h[t].p(e,l):(s(),o(h[a],1,1,(()=>{h[a]=null})),c(),n=h[t],n?n.p(e,l):(n=h[t]=u[t](e),n.c()),r(n,1),n.m(i.parentNode,i))},i(e){p||(r(n),p=!0)},o(e){o(n),p=!1},d(e){h[t].d(e),e&&d(i)}}}function Le(e,t,n){let{$$slots:i={},$$scope:l}=t,{standalone:a=!1}=t,{shieldKey:s}=t,{title:o}=t,{desc:c}=t,{enableShield:r={}}=t;const d=he[s],p=me(s),{Container:u}=se;return e.$$set=e=>{"standalone"in e&&n(0,a=e.standalone),"shieldKey"in e&&n(1,s=e.shieldKey),"title"in e&&n(2,o=e.title),"desc"in e&&n(3,c=e.desc),"enableShield"in e&&n(4,r=e.enableShield),"$$scope"in e&&n(9,l=e.$$scope)},[a,s,o,c,r,d,p,u,i,l]}class Ke extends e{constructor(e){super(),t(this,e,Le,Ve,n,{standalone:0,shieldKey:1,title:2,desc:3,enableShield:4})}}function Ue(e){let t,n;return t=new Ke({props:{shieldKey:"behavior",standalone:e[0],title:re.title,desc:re.desc,enableShield:e[1]}}),{c(){P(t.$$.fragment)},m(e,i){_(t,e,i),n=!0},p(e,[n]){const i={};1&n&&(i.standalone=e[0]),t.$set(i)},i(e){n||(r(t.$$.fragment,e),n=!0)},o(e){o(t.$$.fragment,e),n=!1},d(e){D(t,e)}}}function He(e){const t=J.isLicensed("BehaviorShield")&&J.isInstalled("BehaviorShield")&&ue();return e&&delete t.enableShield,{title:re.title,desc:re.desc,items:t}}function ze(e,t,n){let{standalone:i=!1}=t;const{enableShield:l}=ue();return e.$$set=e=>{"standalone"in e&&n(0,i=e.standalone)},[i,l]}class Ge extends e{constructor(e){super(),t(this,e,ze,Ue,n,{standalone:0})}}const Xe={title:"shields.file",desc:"shields.file.desc",enableFileShield:"shields.settings.enableFileShield",scanAutorun:"shields.settings.scanAutorun",scanAutorunDesc:"shields.settings.scanAutorun.desc",selectFileTypes:"shields.settings.selectFileTypes",selectFileTypesRecommended:"shields.settings.selectFileTypes.recommended",selectFileTypesAll:"shields.settings.selectFileTypes.all",scanOnExecute:"shields.settings.scanOnExecute",scanOnOpen:"shields.settings.scanOnOpen",scanOnWrite:"shields.settings.scanOnWrite"};function qe(){return{enableShield:{id:"stg-shield-file-checkbox",label:K(Xe.enableFileShield),search:Xe.enableFileShield},scanAutorun:{label:K(Xe.scanAutorun),desc:K(Xe.scanAutorunDesc),path:"avcfg://FileSystemShield/FileSystem/ScanAutorun",track:{subject:"Scan autorun"},search:Xe.scanAutorun},fileTypes:{label:K(Xe.selectFileTypes),path:["avcfg://FileSystemShield/FileSystem/ScanOnWriteAllFiles","avcfg://FileSystemShield/FileSystem/ScanOnOpenAllFiles"],options:[{label:K(Xe.selectFileTypesRecommended),value:"0"},{label:K(Xe.selectFileTypesAll),value:"1"}],track:{subject:"File types to scan",valueMap:{0:"Recommended",1:"All"}},search:{title:Xe.selectFileTypes,others:[Xe.selectFileTypesRecommended,Xe.selectFileTypesAll]}},scanOnExecute:{label:K(Xe.scanOnExecute),path:"avcfg://FileSystemShield/FileSystem/ScanOnExecute",track:{subject:"Scan on execute"},search:Xe.scanOnExecute},scanOnOpen:{label:K(Xe.scanOnOpen),path:"avcfg://FileSystemShield/FileSystem/ScanOnOpenDocuments",track:{subject:"Scan on open"},search:Xe.scanOnOpen},scanOnWrite:{label:K(Xe.scanOnWrite),path:"avcfg://FileSystemShield/FileSystem/ScanOnWriteDefault",track:{subject:"Scan on write"},search:Xe.scanOnWrite}}}function Ye(e){let t,n,l,s,c,p,u,h,b,m;return t=new e[7]({props:{prop:e[2]}}),l=new e[8]({props:{prop:e[3]}}),c=new e[7]({props:{prop:e[4]}}),u=new e[7]({props:{prop:e[5]}}),b=new e[7]({props:{prop:e[6]}}),{c(){P(t.$$.fragment),n=i(),P(l.$$.fragment),s=i(),P(c.$$.fragment),p=i(),P(u.$$.fragment),h=i(),P(b.$$.fragment)},m(e,i){_(t,e,i),a(e,n,i),_(l,e,i),a(e,s,i),_(c,e,i),a(e,p,i),_(u,e,i),a(e,h,i),_(b,e,i),m=!0},p:g,i(e){m||(r(t.$$.fragment,e),r(l.$$.fragment,e),r(c.$$.fragment,e),r(u.$$.fragment,e),r(b.$$.fragment,e),m=!0)},o(e){o(t.$$.fragment,e),o(l.$$.fragment,e),o(c.$$.fragment,e),o(u.$$.fragment,e),o(b.$$.fragment,e),m=!1},d(e){D(t,e),e&&d(n),D(l,e),e&&d(s),D(c,e),e&&d(p),D(u,e),e&&d(h),D(b,e)}}}function Je(e){let t,n;return t=new Ke({props:{shieldKey:"file",standalone:e[0],title:Xe.title,desc:Xe.desc,enableShield:e[1],$$slots:{default:[Ye]},$$scope:{ctx:e}}}),{c(){P(t.$$.fragment)},m(e,i){_(t,e,i),n=!0},p(e,[n]){const i={};1&n&&(i.standalone=e[0]),512&n&&(i.$$scope={dirty:n,ctx:e}),t.$set(i)},i(e){n||(r(t.$$.fragment,e),n=!0)},o(e){o(t.$$.fragment,e),n=!1},d(e){D(t,e)}}}function Qe(e){const t=J.isLicensed("FileShield")&&J.isInstalled("FileShield")&&qe();return e&&delete t.enableShield,{title:Xe.title,desc:Xe.desc,items:t}}function Ze(e,t,n){let{standalone:i=!1}=t;const{enableShield:l,scanAutorun:a,fileTypes:s,scanOnExecute:o,scanOnOpen:c,scanOnWrite:r}=qe(),{Checkbox:d,Radio:p}=se;return e.$$set=e=>{"standalone"in e&&n(0,i=e.standalone)},[i,l,a,s,o,c,r,d,p]}class et extends e{constructor(e){super(),t(this,e,Ze,Je,n,{standalone:0})}}const tt={title:"shields.email",desc:"shields.email.desc",enableMailShield:"shields.settings.enableMailShield",scanInbound:"shields.settings.scanInbound",scanOutbound:"shields.settings.scanOutbound",insertNoteCleanMsgOut:"shields.settings.insertNoteCleanMsgOut",markSubjectForVirusMsg:"shields.settings.markSubjectForVirusMsg",scanAttachmentDuringAttaching:"shields.settings.scanAttachmentDuringAttaching",generateReportFile:"shields.settings.generateReportFile",generateReportFileDesc:"shields.settings.generateReportFile.desc"},nt=[{name:"avcfg://***ProviderINI***/Common/Report",objectId:"EmailShield"}];function it(){return G("app.settings.GetValues",nt).then((e=>({locked:e.some((e=>e.locked)),value:e.every((e=>"None"!==e.value))}))).catch((e=>{console.error("loading report file failed",e)}))}function lt(e){const t=nt.map((t=>G("app.settings.Set",Object.assign({value:e?"TXT":"None"},t))));return Promise.all(t)}function at(){return X.importModule("settings","common").then((e=>e.getReportDestination())).then((e=>K(tt.generateReportFileDesc,e,"NAPI.request('app.utils.BrowseFolder', '"+e.replace(/\\/g,"\\\\")+"')")))}function st(){return{enableShield:{id:"stg-shield-mail-checkbox",label:K(tt.enableMailShield),search:tt.enableMailShield},scanInbound:{label:K(tt.scanInbound),path:"avcfg://EmailShield/EmailScanner/ScanInbound",track:{subject:"Scan inbound"},search:tt.scanInbound},scanOutbound:{label:K(tt.scanOutbound),path:"avcfg://EmailShield/EmailScanner/ScanOutbound",track:{subject:"Scan outbound"},search:tt.scanOutbound},insertNoteCleanMsgOut:{label:K(tt.insertNoteCleanMsgOut),path:"avcfg://EmailShield/EmailScanner/InsertNoteCleanMsgOut",track:{subject:"Insert note into clean message"},search:tt.insertNoteCleanMsgOut},markSubjectForVirusMsg:{label:K(tt.markSubjectForVirusMsg),path:"avcfg://EmailShield/EmailScanner/MarkSubjectForVirusMsg",track:{subject:"Mark subject of virus message"},search:tt.markSubjectForVirusMsg},subjectForVirusMsg:{path:"avcfg://EmailShield/EmailScanner/SubjectForVirusMsg",track:{subject:"Virus message subject mark"}},scanAttachmentDuringAttaching:{label:K(tt.scanAttachmentDuringAttaching),path:"avcfg://EmailShield/EmailScanner/ScanAttachmentDuringAttachingMSO",track:{subject:"Scan attachment"},search:tt.scanAttachmentDuringAttaching},generateReportFile:{id:"shields-settings-generateReportFile",label:K(tt.generateReportFile),desc:at,descSanitized:!0,load:it,change:lt,track:{subject:"Generate report file"},testAttr:JSON.stringify(nt),search:tt.generateReportFile}}}function ot(e){let t,n,i;return n=new e[9]({props:{prop:e[6]}}),{c(){t=u("div"),P(n.$$.fragment),h(t,"class","settings__indent")},m(e,l){a(e,t,l),_(n,t,null),i=!0},p:g,i(e){i||(r(n.$$.fragment,e),i=!0)},o(e){o(n.$$.fragment,e),i=!1},d(e){e&&d(t),D(n)}}}function ct(e){let t,n,l,s,c,p,u,h,b,m;return t=new e[8]({props:{prop:e[2]}}),l=new e[8]({props:{prop:e[3]}}),c=new e[8]({props:{prop:e[4]}}),u=new e[8]({props:{prop:e[5],$$slots:{default:[ot]},$$scope:{ctx:e}}}),b=new e[8]({props:{prop:e[7]}}),{c(){P(t.$$.fragment),n=i(),P(l.$$.fragment),s=i(),P(c.$$.fragment),p=i(),P(u.$$.fragment),h=i(),P(b.$$.fragment)},m(e,i){_(t,e,i),a(e,n,i),_(l,e,i),a(e,s,i),_(c,e,i),a(e,p,i),_(u,e,i),a(e,h,i),_(b,e,i),m=!0},p(e,t){const n={};1024&t&&(n.$$scope={dirty:t,ctx:e}),u.$set(n)},i(e){m||(r(t.$$.fragment,e),r(l.$$.fragment,e),r(c.$$.fragment,e),r(u.$$.fragment,e),r(b.$$.fragment,e),m=!0)},o(e){o(t.$$.fragment,e),o(l.$$.fragment,e),o(c.$$.fragment,e),o(u.$$.fragment,e),o(b.$$.fragment,e),m=!1},d(e){D(t,e),e&&d(n),D(l,e),e&&d(s),D(c,e),e&&d(p),D(u,e),e&&d(h),D(b,e)}}}function rt(e){let t,n;return t=new Ke({props:{shieldKey:"email",standalone:e[0],title:tt.title,desc:tt.desc,enableShield:e[1],$$slots:{default:[ct]},$$scope:{ctx:e}}}),{c(){P(t.$$.fragment)},m(e,i){_(t,e,i),n=!0},p(e,[n]){const i={};1&n&&(i.standalone=e[0]),1024&n&&(i.$$scope={dirty:n,ctx:e}),t.$set(i)},i(e){n||(r(t.$$.fragment,e),n=!0)},o(e){o(t.$$.fragment,e),n=!1},d(e){D(t,e)}}}function dt(e){const t=J.isLicensed("MailShield")&&J.isInstalled("MailShield")&&st();return e&&delete t.enableShield,{title:tt.title,desc:tt.desc,items:t}}function pt(e,t,n){let{standalone:i=!1}=t;const{enableShield:l,scanInbound:a,scanOutbound:s,insertNoteCleanMsgOut:o,markSubjectForVirusMsg:c,subjectForVirusMsg:r,scanAttachmentDuringAttaching:d}=st(),{Checkbox:p,TextInput:u}=se;return e.$$set=e=>{"standalone"in e&&n(0,i=e.standalone)},[i,l,a,s,o,c,r,d,p,u]}class ut extends e{constructor(e){super(),t(this,e,pt,rt,n,{standalone:0})}}const ht={title:"shields.web",desc:"shields.web.desc",enableWebShield:"shields.settings.enableWebShield",httpsScanning:"shields.settings.httpsScanning",httpsScanningDesc:"shields.settings.httpsScanning.desc",dnsScanning:"shields.settings.dnsScanning",dnsScanningDesc:"shields.settings.dnsScanning.desc",quicScanning:"shields.settings.quicScanning",quicScanningDesc:"shields.settings.quicScanning.desc",webSocketScanning:"shields.settings.webSocketScanning",webSocketScanningDesc:"shields.settings.webSocketScanning.desc",scriptScanning:"shields.settings.scriptScanning",scriptScanningDesc:"shields.settings.scriptScanning.desc",botnetBlocker:"shields.settings.botnetBlocker",botnetBlockerDesc:"shields.settings.botnetBlocker.desc",siteBlocking:"shields.settings.siteBlocking",siteBlockingDesc:"shields.settings.siteBlocking.desc",addNewBlockedWebsite:"shields.blockedWebsites.addButton",antiFingerprint:"shields.settings.antiFingerprint",antiFingerprintDesc:"shields.settings.antiFingerprint.desc"};function bt(){return{enableShield:{id:"stg-shield-web-checkbox",label:K(ht.enableWebShield),search:ht.enableWebShield},httpsScanning:{label:K(ht.httpsScanning),desc:K(ht.httpsScanningDesc),path:"avcfg://WebShield/WebScanner/HttpsScanning",track:{subject:"Enable HTTPS scanning"},search:ht.httpsScanning},scriptScanning:{label:K(ht.scriptScanning),desc:K(ht.scriptScanningDesc),path:"avcfg://WebShield/WebScanner/ScriptScaning",track:{subject:"Enable script scanning"},search:ht.scriptScanning},siteBlocking:{label:K(ht.siteBlocking),desc:K(ht.siteBlockingDesc),path:"avcfg://WebShield/WebScanner/URLBlocking",track:{subject:"Enable site blocking"},search:ht.siteBlocking},botnetBlocker:{label:K(ht.botnetBlocker),desc:K(ht.botnetBlockerDesc),path:"avcfg://WebShield/ConnectionBlocker/BotnetBlocker",track:{subject:"Block botnet attacks"},search:ht.botnetBlocker},addNewBlockedWebsite:{id:"stg-shield-web-addNewBlockedWebsite",label:K(ht.addNewBlockedWebsite),search:ht.addNewBlockedWebsite},quicScanning:{label:K(ht.quicScanning),desc:K(ht.quicScanningDesc),path:"avcfg://WebShield/Quic/Enabled",track:{subject:"Enable QUIC/HTTP3 scanning"},search:ht.quicScanning},dnsScanning:{label:K(ht.dnsScanning),desc:K(ht.dnsScanningDesc),path:"avcfg://settings/SecDns/TrafficScanning",track:{subject:"Enable DNS/DoH scanning"},search:ht.dnsScanning},webSocketScanning:{label:K(ht.webSocketScanning),desc:K(ht.webSocketScanningDesc),path:"avcfg://WebShield/WebSocket/Enabled",track:{subject:"Enable WebSocket protocol scanning"},search:ht.webSocketScanning},antiFingerprint:{label:K(ht.antiFingerprint),desc:K(ht.antiFingerprintDesc),path:"avcfg://StreamFilter/HttpPlugin/ATisOn",track:{subject:"Enable AntiFingerprint"}}}}const mt="avcfg://WebShield/WebScanner/BlockedURLs",gt=$e([],(function(e){Z.getValue(mt).then((t=>{e(t.split(";").filter((e=>""!==e.trim())))})).catch((e=>{console.error("loading the blocked websites failed",e)}))})),ft=ye(gt,(e=>e));function St(e){Z.set(mt,e.join(";"))}function vt(e){O(e,"svelte-1g6f7n8",".wsh_table__row.svelte-1g6f7n8{grid-template-columns:auto 10rem}.wsh_inputWrapper.svelte-1g6f7n8{height:8rem}")}function $t(e,t,n){const i=e.slice();return i[21]=t[n],i[23]=n,i}function yt(e){let t;return{c(){t=u("p"),t.textContent=`${K(e[8].noBlockedWebsites)}`,h(t,"class","p -small -secondary g-margin--20")},m(e,n){a(e,t,n)},p:g,d(e){e&&d(t)}}}function kt(e){let t,n=[],i=new Map,s=e[6];const o=e=>e[23];for(let l=0;l<s.length;l+=1){let t=$t(e,s,l),a=o(t);i.set(a,n[l]=wt(a,t))}return{c(){for(let e=0;e<n.length;e+=1)n[e].c();t=l()},m(e,i){for(let t=0;t<n.length;t+=1)n[t].m(e,i);a(e,t,i)},p(e,l){12352&l&&(s=e[6],n=N(n,l,o,1,e,s,i,t.parentNode,R,wt,t,$t))},d(e){for(let t=0;t<n.length;t+=1)n[t].d(e);e&&d(t)}}}function wt(e,t){let n,l,s,o,c,r,p,g,f,S,v,$,I,A,C,x=t[21]+"";function T(){return t[18](t[21],t[23])}function P(){return t[19](t[23])}return{key:e,first:null,c(){n=u("div"),l=u("div"),s=y(x),o=i(),c=u("div"),r=u("kin-button"),p=u("kin-icon"),f=i(),S=u("kin-button"),v=u("kin-icon"),I=i(),h(l,"class","kin_table__name"),h(l,"data-test","blockedwebsites-row-name"),b(p,"name","icon-m-action-pen"),b(p,"size","18"),b(r,"aria-label",g=K("global.edit")+" "+t[21]),b(r,"icononly",""),b(r,"type","blank"),b(r,"size","small"),b(r,"data-test","blockedwebsites-row-edit"),b(v,"name","icon-s-controls-close"),b(v,"size","14"),b(S,"aria-label",$=K("global.remove")+" "+t[21]),b(S,"icononly",""),b(S,"type","blank"),b(S,"size","small"),b(S,"data-test","blockedwebsites-row-remove"),h(c,"class","kin_table__actions"),h(n,"class","kin_table__row wsh_table__row svelte-1g6f7n8"),h(n,"data-test","blockedwebsites-row-category-url"),this.first=n},m(e,t){a(e,n,t),k(n,l),k(l,s),k(n,o),k(n,c),k(c,r),k(r,p),k(c,f),k(c,S),k(S,v),k(n,I),A||(C=[m(r,"click",T),m(S,"click",P)],A=!0)},p(e,n){t=e,64&n&&x!==(x=t[21]+"")&&w(s,x),64&n&&g!==(g=K("global.edit")+" "+t[21])&&b(r,"aria-label",g),64&n&&$!==($=K("global.remove")+" "+t[21])&&b(S,"aria-label",$)},d(e){e&&d(n),A=!1,E(C)}}}function It(e){let t,n;return t=new ne({props:{title:K(null!==e[0]?e[8].editWebsite:e[8].addWebsite),subtitle:K(e[8].addWebsiteDesc),$$slots:{"modal-footer":[Ct],"modal-content":[At]},$$scope:{ctx:e}}}),t.$on("close",e[14]),{c(){P(t.$$.fragment)},m(e,i){_(t,e,i),n=!0},p(e,n){const i={};1&n&&(i.title=K(null!==e[0]?e[8].editWebsite:e[8].addWebsite)),16777223&n&&(i.$$scope={dirty:n,ctx:e}),t.$set(i)},i(e){n||(r(t.$$.fragment,e),n=!0)},o(e){o(t.$$.fragment,e),n=!1},d(e){D(t,e)}}}function At(e){let t,n,i,l,s,o,c;return{c(){t=u("div"),n=u("form"),i=u("div"),l=u("kin-input"),b(l,"label",K(e[8].modalInputLabel)),b(l,"error",s=e[2]?K(e[8].error[e[2]]):""),b(l,"value",e[1]),b(l,"data-test","blockedwebsites-input"),b(l,"placeholder",K(e[8].modalInputPlaceholder)),h(i,"class","wsh_inputWrapper svelte-1g6f7n8"),h(t,"slot","modal-content")},m(s,r){a(s,t,r),k(t,n),k(n,i),k(i,l),o||(c=[m(l,"input",e[20]),m(n,"submit",F(e[15]))],o=!0)},p(e,t){4&t&&s!==(s=e[2]?K(e[8].error[e[2]]):"")&&b(l,"error",s),2&t&&b(l,"value",e[1])},d(e){e&&d(t),o=!1,E(c)}}}function Ct(e){let t,n,l,s,o,c,r,p,g=K(null!==e[0]?"global.save":"global.block")+"";return{c(){t=u("div"),n=u("kin-button"),l=y(g),o=i(),c=u("kin-button"),c.textContent=`${K("global.cancel")}`,b(n,"kin-disabled",s=""===e[1].trim()),b(n,"data-test","blockedwebsites-submit"),b(c,"type","secondary"),h(t,"slot","modal-footer")},m(i,s){a(i,t,s),k(t,n),k(n,l),k(t,o),k(t,c),r||(p=[m(n,"click",e[15]),m(c,"click",e[14])],r=!0)},p(e,t){1&t&&g!==(g=K(null!==e[0]?"global.save":"global.block")+"")&&w(l,g),2&t&&s!==(s=""===e[1].trim())&&b(n,"kin-disabled",s)},d(e){e&&d(t),r=!1,E(p)}}}function xt(e){let t,n,l,p,f,S,v,$,I,A,x,T,E,O,F=K("shields.blockedWebsites.tableTitle",e[6].length)+"";n=new e[9]({props:{prop:e[5]}}),n.$on("value",e[17]);let N=!e[7]&&function(e){let t,n,l,s,o,c,r,p,g=e[4].label+"";return{c(){t=u("div"),n=u("kin-button"),l=u("kin-icon"),s=i(),o=y(g),b(l,"name","icon-s-add"),b(l,"size","20"),b(n,"type","secondary"),b(n,"size","small"),b(n,"id",c=e[4].id),h(t,"class","settings__indent g-margin-bottom--15"),C(t,"-disabled",!e[3])},m(i,c){a(i,t,c),k(t,n),k(n,l),k(n,s),k(n,o),r||(p=m(n,"click",e[10]),r=!0)},p(e,i){16&i&&g!==(g=e[4].label+"")&&w(o,g),16&i&&c!==(c=e[4].id)&&b(n,"id",c),8&i&&C(t,"-disabled",!e[3])},d(e){e&&d(t),r=!1,p()}}}(e);function R(e,t){return e[6].length?kt:yt}let W=R(e),j=W(e),B=e[7]&&function(e){let t,n,l,s,o,c,r=K(e[8].addWebsite)+"";return{c(){t=u("kin-button"),n=u("kin-icon"),l=i(),s=y(r),b(n,"name","icon-s-add"),b(n,"size","24"),b(t,"size","large"),b(t,"data-test","block_website_main_button"),b(t,"class","sve_one-page__action-single-button")},m(i,r){a(i,t,r),k(t,n),k(t,l),k(t,s),o||(c=m(t,"click",e[10]),o=!0)},p:g,d(e){e&&d(t),o=!1,c()}}}(e),M=null!==e[1]&&It(e);return{c(){t=u("div"),P(n.$$.fragment),l=i(),N&&N.c(),p=i(),f=u("div"),S=u("kin-table"),v=u("div"),$=u("div"),I=y(F),A=i(),x=u("div"),j.c(),T=i(),B&&B.c(),E=i(),M&&M.c(),h(v,"slot","table-header"),h(v,"class","wsh_table__row svelte-1g6f7n8"),h(x,"slot","table-body"),C(x,"g-margin-bottom--60",e[6].length),h(f,"class","settings__indent"),C(f,"-disabled",!e[3])},m(e,i){a(e,t,i),_(n,t,null),k(t,l),N&&N.m(t,null),a(e,p,i),a(e,f,i),k(f,S),k(S,v),k(v,$),k($,I),k(S,A),k(S,x),j.m(x,null),k(f,T),B&&B.m(f,null),k(f,E),M&&M.m(f,null),O=!0},p(e,[t]){const i={};32&t&&(i.prop=e[5]),n.$set(i),e[7]||N.p(e,t),(!O||64&t)&&F!==(F=K("shields.blockedWebsites.tableTitle",e[6].length)+"")&&w(I,F),W===(W=R(e))&&j?j.p(e,t):(j.d(1),j=W(e),j&&(j.c(),j.m(x,null))),64&t&&C(x,"g-margin-bottom--60",e[6].length),e[7]&&B.p(e,t),null!==e[1]?M?(M.p(e,t),2&t&&r(M,1)):(M=It(e),M.c(),r(M,1),M.m(f,null)):M&&(s(),o(M,1,1,(()=>{M=null})),c()),8&t&&C(f,"-disabled",!e[3])},i(e){O||(r(n.$$.fragment,e),r(M),O=!0)},o(e){o(n.$$.fragment,e),o(M),O=!1},d(e){e&&d(t),D(n),N&&N.d(),e&&d(p),e&&d(f),j.d(),B&&B.d(),M&&M.d()}}}const Tt=/^((https?:\/\/)?(www\.)*)((?!www)[\w\-\.]{2,})(\.[\w]{2,}[\w#&?@,\.\/\-?=]*)$/;function Et(e,t,n){let i,l,a;p(e,ft,(e=>n(6,a=e)));let{props:s}=t;const o=J.isTheOne(),{Checkbox:c}=se;let r,d,u=null,h=null;function b(e){n(1,h=e),n(2,r=null)}function m(e,t){n(0,u=t),n(1,h=e)}function g(e){var t;t=e,gt.update((e=>(e.splice(t,1),St(e),e)))}function f(){n(0,u=null),n(1,h=null),n(2,r=null)}return e.$$set=e=>{"props"in e&&n(16,s=e.props)},e.$$.update=()=>{65536&e.$$.dirty&&n(5,i=s.siteBlocking),65536&e.$$.dirty&&n(4,l=s.addNewBlockedWebsite)},[u,h,r,d,l,i,a,o,{addWebsite:"shields.blockedWebsites.addButton",addWebsiteDesc:"shields.blockedWebsites.modal.desc",editWebsite:"shields.blockedWebsites.modal.editTitle",noBlockedWebsites:"shields.settings.blockedWebsites.noWebsites",modalInputLabel:"shields.exceptions.modal.inputLabel",modalInputPlaceholder:"shields.exceptions.modal.inputPlaceholder",error:{url:"settings.blockedWebsites.modal.error.url",duplicity:"shields.blockedWebsites.modal.error.duplicity",spaces:"shields.blockedWebsites.modal.error.spaces"}},c,function(){n(1,h="")},b,m,g,f,function(){var e,t,i;/\s/g.test(h)?n(2,r="spaces"):null===u||h!==a[u]?Tt.test(h)?a.includes(h)?n(2,r="duplicity"):(null!==u?(t=h,i=u,gt.update((e=>(e[i]=t,St(e),e)))):(e=h,gt.update((t=>(t.push(e),St(t),t)))),f()):n(2,r="url"):f()},s,e=>n(3,d=e.detail),(e,t)=>m(e,t),e=>g(e),e=>b(e.target.value)]}class Pt extends e{constructor(e){super(),t(this,e,Et,xt,n,{props:16},vt)}}function _t(e){return{c:g,m:g,p:g,i:g,o:g,d:g}}function Dt(e){let t,n,i=e[12]&&function(e){let t,n;return t=new e[1]({props:{prop:e[10]}}),{c(){P(t.$$.fragment)},m(e,i){_(t,e,i),n=!0},p:g,i(e){n||(r(t.$$.fragment,e),n=!0)},o(e){o(t.$$.fragment,e),n=!1},d(e){D(t,e)}}}(e);return{c(){i&&i.c(),t=l()},m(e,l){i&&i.m(e,l),a(e,t,l),n=!0},p(e,t){e[12]&&i.p(e,t)},i(e){n||(r(i),n=!0)},o(e){o(i),n=!1},d(e){i&&i.d(e),e&&d(t)}}}function Ot(e){return{c:g,m:g,p:g,i:g,o:g,d:g}}function Ft(e){let t,n,l,s,c,p,u,h,b,m,f,S,v,$,y=ee.supportedSince("23.5");t=new e[1]({props:{prop:e[4]}}),l=new e[1]({props:{prop:e[5]}}),c=new e[1]({props:{prop:e[6]}});let k=y&&function(e){let t,n;return t=new e[1]({props:{prop:e[7]}}),{c(){P(t.$$.fragment)},m(e,i){_(t,e,i),n=!0},p:g,i(e){n||(r(t.$$.fragment,e),n=!0)},o(e){o(t.$$.fragment,e),n=!1},d(e){D(t,e)}}}(e);h=new e[1]({props:{prop:e[8]}}),m=new e[1]({props:{prop:e[9]}});let w={ctx:e,current:null,token:null,hasCatch:!1,pending:Ot,then:Dt,catch:_t,value:12,blocks:[,,,]};return W(e[11](),w),v=new Pt({props:{props:e[2]}}),{c(){P(t.$$.fragment),n=i(),P(l.$$.fragment),s=i(),P(c.$$.fragment),p=i(),k&&k.c(),u=i(),P(h.$$.fragment),b=i(),P(m.$$.fragment),f=i(),w.block.c(),S=i(),P(v.$$.fragment)},m(e,i){_(t,e,i),a(e,n,i),_(l,e,i),a(e,s,i),_(c,e,i),a(e,p,i),k&&k.m(e,i),a(e,u,i),_(h,e,i),a(e,b,i),_(m,e,i),a(e,f,i),w.block.m(e,w.anchor=i),w.mount=()=>S.parentNode,w.anchor=S,a(e,S,i),_(v,e,i),$=!0},p(t,n){e=t,y&&k.p(e,n),j(w,e,n)},i(e){$||(r(t.$$.fragment,e),r(l.$$.fragment,e),r(c.$$.fragment,e),r(k),r(h.$$.fragment,e),r(m.$$.fragment,e),r(w.block),r(v.$$.fragment,e),$=!0)},o(e){o(t.$$.fragment,e),o(l.$$.fragment,e),o(c.$$.fragment,e),o(k),o(h.$$.fragment,e),o(m.$$.fragment,e);for(let t=0;t<3;t+=1){const e=w.blocks[t];o(e)}o(v.$$.fragment,e),$=!1},d(e){D(t,e),e&&d(n),D(l,e),e&&d(s),D(c,e),e&&d(p),k&&k.d(e),e&&d(u),D(h,e),e&&d(b),D(m,e),e&&d(f),w.block.d(e),w.token=null,w=null,e&&d(S),D(v,e)}}}function Nt(e){let t,n;return t=new Ke({props:{shieldKey:"web",standalone:e[0],title:ht.title,desc:ht.desc,enableShield:e[3],$$slots:{default:[Ft]},$$scope:{ctx:e}}}),{c(){P(t.$$.fragment)},m(e,i){_(t,e,i),n=!0},p(e,[n]){const i={};1&n&&(i.standalone=e[0]),8192&n&&(i.$$scope={dirty:n,ctx:e}),t.$set(i)},i(e){n||(r(t.$$.fragment,e),n=!0)},o(e){o(t.$$.fragment,e),n=!1},d(e){D(t,e)}}}function Rt(e){const t=J.isLicensed("WebShield")&&J.isInstalled("WebShield")&&bt();return e&&delete t.enableShield,{title:ht.title,desc:ht.desc,items:t}}function Wt(e,t,n){let{standalone:i=!1}=t;const{Checkbox:l}=se,a=bt(),{enableShield:s,httpsScanning:o,quicScanning:c,webSocketScanning:r,dnsScanning:d,botnetBlocker:p,scriptScanning:u,antiFingerprint:h}=a;return e.$$set=e=>{"standalone"in e&&n(0,i=e.standalone)},[i,l,a,s,o,c,r,d,p,u,h,function(){return Z.getValue("avdef://config/GuiCache/AntiFingerprintEnabled",{localStorage:!0,cached:!0}).then((e=>"1"==e))}]}class jt extends e{constructor(e){super(),t(this,e,Wt,Nt,n,{standalone:0})}}function Bt(e){let t,n,i;return n=new e[0]({props:{prop:e[1]}}),{c(){t=u("div"),P(n.$$.fragment)},m(e,l){a(e,t,l),_(n,t,null),i=!0},p:g,i(e){i||(r(n.$$.fragment,e),i=!0)},o(e){o(n.$$.fragment,e),i=!1},d(e){e&&d(t),D(n)}}}const Mt={selectActionVirusAuto:"shields.settings.selectActionVirus.auto",selectActionVirusAutoDesc:"shields.settings.selectActionVirus.auto.desc",selectActionVirusAsk:"shields.settings.selectActionVirus.ask",selectActionVirusAskDesc:"shields.settings.selectActionVirus.ask.desc"},Vt=[Mt.selectActionVirusAuto,Mt.selectActionVirusAutoDesc,Mt.selectActionVirusAsk,Mt.selectActionVirusAskDesc];function Lt(e){const{Radio:t}=se;return[t,{id:"settings_shields_whatToDoWith_viruses",options:[{label:K(Mt.selectActionVirusAuto),desc:K(Mt.selectActionVirusAutoDesc),value:"fix",recommended:!0},{label:K(Mt.selectActionVirusAsk),desc:K(Mt.selectActionVirusAskDesc),value:"interactive"}],path:[{name:"avcfg://***ProviderINI***/Common/VirusAction",objectId:"FileSystemShield"},{name:"avcfg://***ProviderINI***/Common/VirusAction",objectId:"EmailShield"},{name:"avcfg://***ProviderINI***/Common/VirusAction",objectId:"WebShield"},{name:"avcfg://settings/IDP/DetectedAction"}],change(e){const t="fix"===e?"abort":e;return Promise.all([G("app.settings.Set",{name:"avcfg://***ProviderINI***/Common/VirusAction",objectId:"FileSystemShield",value:e}),G("app.settings.Set",{name:"avcfg://***ProviderINI***/Common/VirusAction",objectId:"EmailShield",value:e}),G("app.settings.Set",{name:"avcfg://***ProviderINI***/Common/VirusAction",objectId:"WebShield",value:t}),G("app.settings.Set",{name:"avcfg://settings/IDP/DetectedAction",value:e})])},search:{title:Mt.modeLabel,others:[Mt.smartMode,Mt.smartModeDesc,Mt.strictMode,Mt.strictModeDesc]}}]}class Kt extends e{constructor(e){super(),t(this,e,Lt,Bt,n,{})}}function Ut(e){let t,n,i;return n=new e[6]({props:{prop:e[4]}}),{c(){t=u("div"),P(n.$$.fragment),h(t,"class","settings__indent")},m(e,l){a(e,t,l),_(n,t,null),i=!0},p(e,t){const i={};16&t&&(i.prop=e[4]),n.$set(i)},i(e){i||(r(n.$$.fragment,e),i=!0)},o(e){o(n.$$.fragment,e),i=!1},d(e){e&&d(t),D(n)}}}function Ht(e){let t,n,l,s,c;return n=new e[6]({props:{prop:e[2]}}),s=new e[5]({props:{prop:e[3],$$slots:{default:[Ut]},$$scope:{ctx:e}}}),s.$on("value",e[8]),{c(){t=u("div"),P(n.$$.fragment),l=i(),P(s.$$.fragment),h(t,"class","settings__indent")},m(e,i){a(e,t,i),_(n,t,null),k(t,l),_(s,t,null),c=!0},p(e,t){const i={};4&t&&(i.prop=e[2]),n.$set(i);const l={};8&t&&(l.prop=e[3]),2097168&t&&(l.$$scope={dirty:t,ctx:e}),s.$set(l)},i(e){c||(r(n.$$.fragment,e),r(s.$$.fragment,e),c=!0)},o(e){o(n.$$.fragment,e),o(s.$$.fragment,e),c=!1},d(e){e&&d(t),D(n),D(s)}}}function zt(e){let t,n,i;return n=new e[5]({props:{prop:e[7],$$slots:{default:[Ht]},$$scope:{ctx:e}}}),n.$on("value",e[9]),{c(){t=u("div"),P(n.$$.fragment)},m(e,l){a(e,t,l),_(n,t,null),i=!0},p(e,[t]){const i={};2097182&t&&(i.$$scope={dirty:t,ctx:e}),n.$set(i)},i(e){i||(r(n.$$.fragment,e),i=!0)},o(e){o(n.$$.fragment,e),i=!1},d(e){e&&d(t),D(n)}}}const Gt={pupEnabledLabel:"settings.pup",pupEnabledDesc:"settings.pup.desc",toolEnabledLabel:"settings.pup.tools",toolEnabledDesc:"settings.pup.tools.desc",pupActionFixLabel:"settings.pup.action.fix",pupActionFixDesc:"settings.pup.action.fix.desc",pupActionInteractiveLabel:"settings.pup.action.interactive",pupActionInteractiveDesc:"settings.pup.action.interactive.desc"},Xt=[Gt.pupEnabledLabel,Gt.pupEnabledDesc,Gt.toolEnabledLabel,Gt.toolEnabledDesc,Gt.pupActionFixLabel,Gt.pupActionFixDesc,Gt.pupActionInteractiveLabel,Gt.pupActionInteractiveDesc];function qt(e){return"fix"===e?"abort":e}function Yt(e,t,n){const{Checkbox:i,Radio:l}=se,a={id:"settings_shields_whatToDoWith_unwantedProgram_pupEnabled",label:K(Gt.pupEnabledLabel),desc:K(Gt.pupEnabledDesc),load:function(){return u().then((e=>({value:"1"==e.value||"2"==e.value,locked:e.locked})))},change:function(e){return h(e?"1":"0")},changeEvent:"pupEnabled",track:{subject:"PUP enabled"}},s={id:"settings_shields_whatToDoWith_unwantedProgram_pupAction",load:function(){return G("app.settings.Get",{name:"avcfg://***ProviderINI***/Common/PUPAction",objectId:"FileSystemShield"})},change:function(e){const t=qt(e);return Promise.all([G("app.settings.Set",{name:"avcfg://***ProviderINI***/Common/PUPAction",objectId:"FileSystemShield",value:e}),G("app.settings.Set",{name:"avcfg://***ProviderINI***/Common/PUPAction",objectId:"EmailShield",value:e}),G("app.settings.Set",{name:"avcfg://***ProviderINI***/Common/PUPAction",objectId:"WebShield",value:t})])},options:[{label:K(Gt.pupActionFixLabel),desc:K(Gt.pupActionFixDesc),value:"fix",recommended:!0},{label:K(Gt.pupActionInteractiveLabel),desc:K(Gt.pupActionInteractiveDesc),value:"interactive"}],track:{subject:"PUP action"}},o={id:"settings_shields_whatToDoWith_unwantedProgram_toolsEnabled",label:K(Gt.toolEnabledLabel),desc:K(Gt.toolEnabledDesc),load:function(){return u().then((e=>({value:"2"==e.value,locked:e.locked})))},change:function(e){return h(e?"2":"1")},updateOnEvent:"settings.change.pupEnabled",track:{subject:"Tools enabled"}},c={id:"settings_shields_whatToDoWith_unwantedProgram_toolAction",load:function(){return G("app.settings.Get",{name:"avcfg://***ProviderINI***/Common/ToolAction",objectId:"FileSystemShield"})},change:function(e){const t=qt(e);return Promise.all([G("app.settings.Set",{name:"avcfg://***ProviderINI***/Common/ToolAction",objectId:"FileSystemShield",value:e}),G("app.settings.Set",{name:"avcfg://***ProviderINI***/Common/ToolAction",objectId:"EmailShield",value:e}),G("app.settings.Set",{name:"avcfg://***ProviderINI***/Common/ToolAction",objectId:"WebShield",value:t})])},options:[{label:K("settings.pup.action.fix"),value:"fix"},{label:K("settings.pup.action.interactive"),value:"interactive"}],track:{subject:"Tools action"}};let r,d,p;function u(){return r||(r=G("app.settings.Get",{name:"avcfg://***ProviderINI***/Common/ScanPUP",objectId:"FileSystemShield"})),r}function h(e){r=null;const t=[G("app.settings.Set",{name:"avcfg://***ProviderINI***/Common/ScanPUP",objectId:"FileSystemShield",value:e}),G("app.settings.Set",{name:"avcfg://***ProviderINI***/Common/ScanPUP",objectId:"EmailShield",value:e}),G("app.settings.Set",{name:"avcfg://***ProviderINI***/Common/ScanPUP",objectId:"WebShield",value:e})];return Promise.all(t)}return e.$$.update=()=>{3&e.$$.dirty&&(n(2,s.disabled=!d,s),n(3,o.disabled=!d,o),n(4,c.disabled=!p,c))},[d,p,s,o,c,i,l,a,e=>n(1,p=e.detail),e=>n(0,d=e.detail)]}class Jt extends e{constructor(e){super(),t(this,e,Yt,zt,n,{})}}const Qt={title:"shields",desc:"shields.settings.desc",whatToDoWith:"shields.settings.whatToDoWith",whatToDoWithViruses:"shields.settings.whatToDoWith.malware",whatToDoWithUnwantedProgram:"shields.settings.whatToDoWith.pupAndTools",shield:{file:"shields.file",behavior:"shields.behavior",web:"shields.web",mail:"shields.email"},shieldTypeSettings:"shields.settings.shieldTypeSettings",enableCyberCapture:"shields.settings.enableCyberCapture",enableCyberCaptureDesc:"shields.settings.enableCyberCapture.desc",cyberCaptureSendForAnalysisAuto:"shields.settings.cyberCapture.sendForAnalysis.auto",cyberCaptureSendForAnalysisAsk:"shields.settings.cyberCapture.sendForAnalysis.ask",enableHardenedMode:"shields.settings.enableHardenedMode",enableHardenedModeDesc:"shields.settings.enableHardenedMode.desc",enableExploitDetection:"shields.settings.enableExploitDetection",enableRootkitDetection:"shields.settings.enableRootkitDetection",generateReportFile:"shields.settings.generateReportFile",generateReportFileDesc:"shields.settings.generateReportFile.desc"},Zt=[{name:"avcfg://***ProviderINI***/Common/Report",objectId:"FileSystemShield"},{name:"avcfg://***ProviderINI***/Common/Report",objectId:"WebShield"},{name:"avcfg://***ProviderINI***/Common/Report",objectId:"EmailShield"}];function en(){return Promise.resolve({value:J.isEnabled("AntiRootkit"),locked:!1})}function tn(e){return e?te.enable("AntiRootkit").then((e=>J.enableFeature("AntiExploit"))):te.disable("AntiRootkit")}function nn(){return Promise.resolve({value:J.isEnabled("AntiExploit"),locked:!1})}function ln(e){return e?te.enable("AntiExploit"):te.disable("AntiExploit")}function an(){return G("app.settings.GetValues",Zt).then((e=>({locked:e.some((e=>e.locked)),value:e.every((e=>"None"!==e.value))}))).catch((e=>{console.error("loading report file failed",e)}))}function sn(e){const t=Zt.map((t=>G("app.settings.Set",Object.assign({value:e?"TXT":"None"},t))));return Promise.all(t)}function on(){return X.importModule("settings","common").then((e=>e.getReportDestination())).then((e=>K(Qt.generateReportFileDesc,e,"NAPI.request('app.utils.BrowseFolder', '"+e.replace(/\\/g,"\\\\")+"')")))}function cn(e){const t={sensitivity:{path:[{name:"avcfg://***ProviderINI***/Common/TaskSensitivity",objectId:"FileSystemShield"},{name:"avcfg://***ProviderINI***/Common/TaskSensitivity",objectId:"BehaviorShield"},{name:"avcfg://***ProviderINI***/Common/TaskSensitivity",objectId:"WebShield"},{name:"avcfg://***ProviderINI***/Common/TaskSensitivity",objectId:"EmailShield"}],options:[{value:"40",label:K("settings.sensitivity.low")},{value:"80",label:K("settings.sensitivity.medium")},{value:"100",label:K("settings.sensitivity.high")}],track:{subject:"Sensitivity",valueMap:{40:"Low",80:"Medium",100:"High"}}},whatToDoWithViruses:{id:"stg-shields-whatToDoWithViruses",idAttr:"stg-shields-whatToDoWithViruses",tabId:"viruses",compo:{constructor:Kt},title:K(Qt.whatToDoWithViruses),type:"tab",search:{title:Qt.whatToDoWithViruses,others:Vt}},whatToDoWithUnwantedProgram:{id:"stg-shields-whatToDoWithUnwantedProgram",idAttr:"stg-shields-whatToDoWithUnwantedProgram",tabId:"unwantedProgram",compo:{constructor:Jt},title:K(Qt.whatToDoWithUnwantedProgram),type:"tab",search:{title:Qt.whatToDoWithUnwantedProgram,others:Xt}},enableCyberCapture:{label:K(Qt.enableCyberCapture),desc:K(Qt.enableCyberCaptureDesc),path:"avcfg://avast5/Common/AutoSandboxEnabled",track:{subject:"Enable CyberCapture"},search:{title:Qt.enableCyberCapture,desc:Qt.enableCyberCaptureDesc,others:[Qt.cyberCaptureSendForAnalysisAuto,Qt.cyberCaptureSendForAnalysisAsk]}},enableCyberCaptureOptions:{path:"avcfg://avast5/Custody/AutomaticallySendForAnalysis",options:[{label:K(Qt.cyberCaptureSendForAnalysisAuto),value:"1"},{label:K(Qt.cyberCaptureSendForAnalysisAsk),value:"0"}],track:{subject:"Send files to Threat Labs",valueMap:{1:"Automatically",0:"Ask"}}},enableHardenedMode:{label:K(Qt.enableHardenedMode),desc:K(Qt.enableHardenedModeDesc),path:"avcfg://avast5/Common/HardenedMode",track:{subject:"Enable Hardened mode"},search:{title:Qt.enableHardenedMode,desc:Qt.enableHardenedModeDesc}},enableRootkitDetection:{id:"stg-shields-rootkitDetections",label:K(Qt.enableRootkitDetection),load:en,change:tn,updateOnEvent:{event:"product.change.feature.AntiRootkit.enabled",getValue:e=>e},track:{subject:"Enable Rootkit detection"},testAttr:"stg-shields-rootkitDetections",search:Qt.enableRootkitDetection},enableExploitDetection:{id:"stg-shields-exploitDetection",label:K(Qt.enableExploitDetection),load:nn,change:ln,updateOnEvent:{event:"product.change.feature.AntiExploit.enabled",getValue:e=>e},track:{subject:"Enable Exploit detection"},testAttr:"stg-shields-exploitDetection",search:Qt.enableExploitDetection},generateReportFile:{id:"shields-settings-generateReportFile",label:K(Qt.generateReportFile),desc:on,descSanitized:!0,load:an,change:sn,track:{subject:"Generate report file"},testAttr:JSON.stringify(Zt),search:Qt.generateReportFile}},n={configureShields:{id:"stg-shields-configureShields",label:K(Qt.shieldTypeSettings),search:Qt.shieldTypeSettings},fileShield:{id:"stg-shields-fileShield",idAttr:"stg-shields-fileShield",tabId:"fileShield",compo:{constructor:et,props:{standalone:e}},title:K(Qt.shield.file),type:"tab",search:{title:Qt.shield.file,items:Qe(!1).items}},behaviorShield:{id:"stg-shields-behaviorShield",idAttr:"stg-shields-behaviorShield",tabId:"behaviorShield",compo:{constructor:Ge,props:{standalone:e}},title:K(Qt.shield.behavior),type:"tab",search:{title:Qt.shield.behavior,items:He(!1).items}},webShield:{id:"stg-shields-webShield",idAttr:"stg-shields-webShield",tabId:"webShield",compo:{constructor:jt,props:{standalone:e}},title:K(Qt.shield.web),type:"tab",search:{title:Qt.shield.web,items:Rt(!1).items}},mailShield:{id:"stg-shields-mailShield",idAttr:"stg-shields-mailShield",tabId:"mailShield",compo:{constructor:ut,props:{standalone:e}},title:K(Qt.shield.mail),type:"tab",search:{title:Qt.shield.mail,items:dt(!1).items}}};return e||(t.configureShields=n.configureShields,t.fileShield=n.fileShield,t.behaviorShield=n.behaviorShield,t.webShield=n.webShield,t.mailShield=n.mailShield),t}const rn=new class extends q{init(){this.SHIELD_IDS=["FileSystemShield","WebShield","EmailShield","BehaviorShield","AntiRootkit","AntiExploit"],this._listeners=this.SHIELD_IDS.map((e=>H.on(`product.change.feature.${e}`,(()=>{this.updateStatus(),this.emit("change",this.status)})))),this.shieldStates={},this._disablingInProgress=!1,this.status={installed:!0},this.updateStatus()}destroy(){this.removeAllListeners(),this._listeners.forEach((e=>e())),this._listeners.length=0,this.shieldPromises={}}loadStatus(){return Promise.resolve(this.status)}updateStatus(){this.SHIELD_IDS.forEach((e=>{J.isInstalled(e)?this.shieldStates[e]=J.isEnabled(e):delete this.shieldStates[e]}));const e=Object.keys(this.shieldStates);this._disablingInProgress?(this.status.enabled=e.every((e=>this.shieldStates[e])),e.every((e=>!this.shieldStates[e]))&&(this._disablingInProgress=!1,this.status.controllable=!0)):(this.status.enabled=e.some((e=>this.shieldStates[e])),this.status.controllable=null==this.status.controllable||this.status.controllable)}toggleEnabled(){this.status.controllable=!1,this.emit("change",this.status);const e=Object.keys(this.shieldStates),t=({enabled:e,time:t})=>{H.emit("Settings.gaTrack","Shields ON/OFF",e?"on":"off",t)};let n;if(this.status.enabled){const i={title:K("shields.turnOffShield"),desc:K("shields.turnOffShield.desc")};this._disablingInProgress=!0,n=te.disable(e,{stopOptions:i,track:t})}else n=te.enable(e,{track:t});return n.then((e=>{this.status.enabled===e&&(this.status.controllable=!0),this.status.enabled=e,this.emit("change",this.status)}))}};function dn(e){let t,n,i;return n=new e[17]({props:{prop:e[1]}}),{c(){t=u("div"),P(n.$$.fragment),h(t,"class","settings__indent")},m(e,l){a(e,t,l),_(n,t,null),i=!0},p(e,t){const i={};2&t[0]&&(i.prop=e[1]),n.$set(i)},i(e){i||(r(n.$$.fragment,e),i=!0)},o(e){o(n.$$.fragment,e),i=!1},d(e){e&&d(t),D(n)}}}function pn(e){let t,n,i;return n=new e[16]({props:{prop:e[2]}}),{c(){t=u("div"),P(n.$$.fragment),h(t,"class","settings__indent")},m(e,l){a(e,t,l),_(n,t,null),i=!0},p(e,t){const i={};4&t[0]&&(i.prop=e[2]),n.$set(i)},i(e){i||(r(n.$$.fragment,e),i=!0)},o(e){o(n.$$.fragment,e),i=!1},d(e){e&&d(t),D(n)}}}function un(e){let t,n,l,s,c,p,b=e[9].label+"";function m(t){e[21](t)}let g={tabs:e[13]};return void 0!==e[3]&&(g.selectedTabId=e[3]),s=new ie({props:g}),B.push((()=>M(s,"selectedTabId",m))),{c(){t=u("p"),n=y(b),l=i(),P(s.$$.fragment),h(t,"class","p g-margin-top--20"),h(t,"id",e[9].id)},m(e,i){a(e,t,i),k(t,n),a(e,l,i),_(s,e,i),p=!0},p(e,t){const n={};!c&&8&t[0]&&(c=!0,n.selectedTabId=e[3],V((()=>c=!1))),s.$set(n)},i(e){p||(r(s.$$.fragment,e),p=!0)},o(e){o(s.$$.fragment,e),p=!1},d(e){e&&d(t),e&&d(l),D(s,e)}}}function hn(e){let t,n,l,p,b,m,g,f,S,v,$,y,w,I,A,C,x;function T(t){e[18](t)}t=new e[15]({props:{prop:e[5]}});let E={tabs:e[12]};void 0!==e[4]&&(E.selectedTabId=e[4]),b=new ie({props:E}),B.push((()=>M(b,"selectedTabId",T))),S=new e[16]({props:{prop:e[6],$$slots:{default:[dn]},$$scope:{ctx:e}}}),S.$on("value",e[19]),$=new e[16]({props:{prop:e[7]}}),w=new e[16]({props:{prop:e[8],$$slots:{default:[pn]},$$scope:{ctx:e}}}),w.$on("value",e[20]);let O=!e[0]&&un(e);return C=new e[16]({props:{prop:e[10]}}),{c(){P(t.$$.fragment),n=i(),l=u("p"),l.textContent=`${K(Qt.whatToDoWith)}`,p=i(),P(b.$$.fragment),g=i(),f=u("div"),P(S.$$.fragment),v=i(),P($.$$.fragment),y=i(),P(w.$$.fragment),I=i(),O&&O.c(),A=i(),P(C.$$.fragment),h(l,"class","p g-margin-top--15")},m(e,i){_(t,e,i),a(e,n,i),a(e,l,i),a(e,p,i),_(b,e,i),a(e,g,i),a(e,f,i),_(S,f,null),k(f,v),_($,f,null),k(f,y),_(w,f,null),k(f,I),O&&O.m(f,null),k(f,A),_(C,f,null),x=!0},p(e,t){const n={};!m&&16&t[0]&&(m=!0,n.selectedTabId=e[4],V((()=>m=!1))),b.$set(n);const i={};2&t[0]|1&t[1]&&(i.$$scope={dirty:t,ctx:e}),S.$set(i);const l={};4&t[0]|1&t[1]&&(l.$$scope={dirty:t,ctx:e}),w.$set(l),e[0]?O&&(s(),o(O,1,1,(()=>{O=null})),c()):O?(O.p(e,t),1&t[0]&&r(O,1)):(O=un(e),O.c(),r(O,1),O.m(f,A))},i(e){x||(r(t.$$.fragment,e),r(b.$$.fragment,e),r(S.$$.fragment,e),r($.$$.fragment,e),r(w.$$.fragment,e),r(O),r(C.$$.fragment,e),x=!0)},o(e){o(t.$$.fragment,e),o(b.$$.fragment,e),o(S.$$.fragment,e),o($.$$.fragment,e),o(w.$$.fragment,e),o(O),o(C.$$.fragment,e),x=!1},d(e){D(t,e),e&&d(n),e&&d(l),e&&d(p),D(b,e),e&&d(g),e&&d(f),D(S),D($),D(w),O&&O.d(),D(C)}}}function bn(e){let t,n;return t=new e[14]({props:{componentService:rn,title:K(Qt.title),desc:K(Qt.desc),stopOptions:e[11],$$slots:{default:[hn]},$$scope:{ctx:e}}}),{c(){P(t.$$.fragment)},m(e,i){_(t,e,i),n=!0},p(e,n){const i={};31&n[0]|1&n[1]&&(i.$$scope={dirty:n,ctx:e}),t.$set(i)},i(e){n||(r(t.$$.fragment,e),n=!0)},o(e){o(t.$$.fragment,e),n=!1},d(e){D(t,e)}}}function mn(e,t,n){let{shieldsSeparately:i=!1}=t;const{whatToDoWithViruses:l,whatToDoWithUnwantedProgram:a,fileShield:s,behaviorShield:o,webShield:c,mailShield:r,sensitivity:d,enableCyberCapture:p,enableCyberCaptureOptions:u,enableHardenedMode:h,enableRootkitDetection:b,enableExploitDetection:m,configureShields:g,generateReportFile:f}=cn(i),S={title:K("antiransomware.stopOptions.title"),desc:K("antiransomware.stopOptions.desc")},v=[l,a],$=[s,o,c,r];let y,k;H.on("settings.selectTab",(e=>{const t=v.find((t=>t.idAttr===e)),i=$.find((t=>t?.idAttr===e));t&&n(4,k=t.tabId),i&&n(3,y=i.tabId)})),["FileSystemShield","WebShield","EmailShield","BehaviorShield","AntiRootkit","AntiExploit"].forEach((e=>{J.isInstalled(e)&&J.isEnabled(e)}));const{Container:w,Range:I,Checkbox:A,Radio:C}=se;return e.$$set=e=>{"shieldsSeparately"in e&&n(0,i=e.shieldsSeparately)},[i,u,m,y,k,d,p,h,b,g,f,S,v,$,w,I,A,C,function(e){k=e,n(4,k)},e=>n(1,u.disabled=!e.detail,u),e=>n(2,m.disabled=!e.detail,m),function(e){y=e,n(3,y)}]}let gn=class extends e{constructor(e){super(),t(this,e,mn,bn,n,{shieldsSeparately:0},null,[-1,-1])}};const fn={id:"behaviorShield",titleId:"shields.behavior",componentId:"ais_shl_bhv",loadProps:()=>[{label:"How to deal with suspicious program behavior",path:"avcfg://settings/IDP/DetectedAction",type:"select",options:[{label:"Always ask",value:"1"},{label:K("geek.behavShield.detected.label"),value:"2"},{label:K("geek.behavShield.known.label"),value:"3"}]}]},Sn={name:"avcfg://***ProviderINI***/Common/VirusAction",objectId:"FileSystemShield"},vn={name:"avcfg://***ProviderINI***/Common/PUPAction",objectId:"FileSystemShield"},$n={name:"avcfg://***ProviderINI***/Common/ToolAction",objectId:"FileSystemShield"},yn={name:"avcfg://***ProviderINI***/Common/SuspiciousAction",objectId:"FileSystemShield"},kn=" iffailed ",wn=[{label:"Fix automatically",value:"fix"},{label:K("geek.move.to.chest"),value:"trezor"},{label:"Repair",value:"repair"},{label:"Abort connection",value:"abort"},{label:"Ask",value:"interactive"},{label:"Delete",value:"delete"},{label:"Nothing",value:""}];function In(e,t){return G("app.settings.Get",e).then((e=>{const n=e.value&&e.value.split(kn);return{value:n&&n[t]||"",locked:e.locked}}))}function An(e,t,n){return G("app.settings.Get",e).then((e=>e.value&&e.value.split(kn)||[])).then((e=>(e[t]=n,e.filter((e=>e)).join(kn)))).then((t=>G("app.settings.Set",Object.assign({value:t},e))))}const Cn={id:"fileShield",titleId:"shields.file",componentId:"ais_shl_fil",loadProps:()=>[{label:"Action to be performed when a virus is found",path:Sn,load:In.bind(null,Sn,0),change:An.bind(null,Sn,0),emitOnChange:"settings.change.fileShield.virusAction",updateOnEvent:"settings.change.fileShield.virusAction",type:"select",options:wn},{label:"if the action above fails, then",path:Sn,load:In.bind(null,Sn,1),change:An.bind(null,Sn,1),emitOnChange:"settings.change.fileShield.virusAction",updateOnEvent:"settings.change.fileShield.virusAction",type:"select",options:wn,unsearchable:!0},{label:"if the action above fails, then",path:Sn,load:In.bind(null,Sn,2),change:An.bind(null,Sn,2),emitOnChange:"settings.change.fileShield.virusAction",updateOnEvent:"settings.change.fileShield.virusAction",type:"select",options:wn,unsearchable:!0},{label:"Action to be performed when a potentially unwanted program is found",path:vn,load:In.bind(null,vn,0),change:An.bind(null,vn,0),emitOnChange:"settings.change.fileShield.pupAction",updateOnEvent:"settings.change.fileShield.pupAction",type:"select",options:wn},{label:"if the action above fails, then",path:vn,load:In.bind(null,vn,1),change:An.bind(null,vn,1),emitOnChange:"settings.change.fileShield.pupAction",updateOnEvent:"settings.change.fileShield.pupAction",type:"select",options:wn,unsearchable:!0},{label:"if the action above fails, then",path:vn,load:In.bind(null,vn,2),change:An.bind(null,vn,2),emitOnChange:"settings.change.fileShield.pupAction",updateOnEvent:"settings.change.fileShield.pupAction",type:"select",options:wn,unsearchable:!0},{label:"Action to be performed when a potentially unwanted tool is found",path:$n,load:In.bind(null,$n,0),change:An.bind(null,$n,0),emitOnChange:"settings.change.fileShield.toolAction",updateOnEvent:"settings.change.fileShield.toolAction",type:"select",options:wn},{label:"if the action above fails, then",path:$n,load:In.bind(null,$n,1),change:An.bind(null,$n,1),emitOnChange:"settings.change.fileShield.toolAction",updateOnEvent:"settings.change.fileShield.toolAction",type:"select",options:wn,unsearchable:!0},{label:"if the action above fails, then",path:$n,load:In.bind(null,$n,2),change:An.bind(null,$n,2),emitOnChange:"settings.change.fileShield.toolAction",updateOnEvent:"settings.change.fileShield.toolAction",type:"select",options:wn,unsearchable:!0},{label:"Action to be performed when a suspicious object is found",path:yn,load:In.bind(null,yn,0),change:An.bind(null,yn,0),emitOnChange:"settings.change.fileShield.suspiciousAction",updateOnEvent:"settings.change.fileShield.suspiciousAction",type:"select",options:wn},{label:"if the action above fails, then",path:yn,load:In.bind(null,yn,1),change:An.bind(null,yn,1),emitOnChange:"settings.change.fileShield.suspiciousAction",updateOnEvent:"settings.change.fileShield.suspiciousAction",type:"select",options:wn,unsearchable:!0},{label:"if the action above fails, then",path:yn,load:In.bind(null,yn,2),change:An.bind(null,yn,2),emitOnChange:"settings.change.fileShield.suspiciousAction",updateOnEvent:"settings.change.fileShield.suspiciousAction",type:"select",options:wn,unsearchable:!0},{label:"Show a notification window when action is taken",path:{name:"avcfg://***ProviderINI***/Common/ShowAppliedActionNotification",objectId:"FileSystemShield"},type:"checkbox"},{label:"Enable Antimalware Scan Interface (AMSI) scanner",path:{name:"avcfg://settings/AMSI/Enabled"},type:"checkbox"},{label:"Report file name",path:{name:"avcfg://***ProviderINI***/Common/ReportName",objectId:"FileSystemShield"},type:"text"},{label:"Report file type",path:{name:"avcfg://***ProviderINI***/Common/Report",objectId:"FileSystemShield"},type:"select",options:[{label:"Plain text (ANSI)",value:"TXT"},{label:"Plain text (Unicode)",value:"UTXT"},{label:"XML",value:"XML"}]},{label:"If report file exists",path:{name:"avcfg://***ProviderINI***/Common/OverwriteReport",objectId:"FileSystemShield"},type:"select",options:[{label:"Append",value:"0"},{label:"Overwrite",value:"1"}]},{label:"Reported items",desc:"Possible values: Infected, HardErrors, SoftErrors, OK, Skipped. Values are separated by semicolon (e.g. OK;Skipped). There may be also values Start and Stop but they have no effect.",path:{name:"avcfg://***ProviderINI***/Common/ReportRecords",objectId:"FileSystemShield"},type:"text"}]},xn={id:"mailShield",titleId:"shields.email",componentId:"ais_shl_mai",loadProps:()=>[{label:"Action to be performed when a virus is found",path:{name:"avcfg://***ProviderINI***/Common/VirusAction",objectId:"EmailShield"},type:"select",options:[{label:"Auto",value:"fix"},{label:"Ask",value:"interactive"},{label:"Nothing",value:"nothing"},{label:K("geek.move.to.chest"),value:"trezor"},{label:"Repair",value:"repair"},{label:"Delete",value:"delete"}]},{label:"Action to be performed when a potentially unwanted program is found",path:{name:"avcfg://***ProviderINI***/Common/PUPAction",objectId:"EmailShield"},type:"select",options:[{label:"Auto",value:"fix"},{label:"Ask",value:"interactive"},{label:"Nothing",value:"nothing"},{label:K("geek.move.to.chest"),value:"trezor"},{label:"Repair",value:"repair"},{label:"Delete",value:"delete"}]},{label:"Action to be performed when a potentially unwanted tool is found",path:{name:"avcfg://***ProviderINI***/Common/ToolAction",objectId:"EmailShield"},type:"select",options:[{label:"Auto",value:"fix"},{label:"Ask",value:"interactive"},{label:"Nothing",value:"nothing"},{label:K("geek.move.to.chest"),value:"trezor"},{label:"Repair",value:"repair"},{label:"Delete",value:"delete"}]},{label:"Action to be performed when a suspicious object is found",path:{name:"avcfg://***ProviderINI***/Common/SuspiciousAction",objectId:"EmailShield"},type:"select",options:[{label:"Auto",value:"fix"},{label:"Ask",value:"interactive"},{label:"Nothing",value:"nothing"},{label:K("geek.move.to.chest"),value:"trezor"},{label:"Repair",value:"repair"},{label:"Delete",value:"delete"}]},{label:"Show a notification window when action is taken",path:{name:"avcfg://***ProviderINI***/Common/ShowAppliedActionNotification",objectId:"EmailShield"},type:"checkbox"},{label:"Scan archived messages when opening",path:"avcfg://EmailShield/EmailScanner/ScanArchivedMessagesMSO",type:"select",options:[{label:"No",value:"0"},{label:"All messages",value:"1"},{label:"Unread messages only",value:"2"}]},{label:"Scan SSL connections",path:"avcfg://EmailShield/EmailScanner/ScanSSL",type:"checkbox"},{id:"mailShield_exportCertificate",label:"Export certificate",type:"button",action:()=>{if(ee.supportedSince("23.7")){const e=K("shields.settings.mailShield.exportCertificateFilter");return G("app.utils.SaveAsDialog",{ext:"der",file_name:"MailShield.der",filter:e}).then((e=>{if("ok"===e.dialogReturnCode)return G("app.utils.ExportCertificate",{filePath:e.pathName,binaryExport:1===e.selectedFilter}).then((()=>{le.inform(K("shields.settings.mailShield.exportCertificateSuccess"))})).catch((()=>{le.inform(K("shields.settings.mailShield.exportCertificateFailed"))}))}))}return G("av.command","app:export_certificate")}},{label:"Report file name",path:{name:"avcfg://***ProviderINI***/Common/ReportName",objectId:"EmailShield"},type:"text"},{label:"Report file type",path:{name:"avcfg://***ProviderINI***/Common/Report",objectId:"EmailShield"},type:"select",options:[{label:"Plain text (ANSI)",value:"TXT"},{label:"Plain text (Unicode)",value:"UTXT"},{label:"XML",value:"XML"}]},{label:"If report file exists",path:{name:"avcfg://***ProviderINI***/Common/OverwriteReport",objectId:"EmailShield"},type:"select",options:[{label:"Append",value:"0"},{label:"Overwrite",value:"1"}]},{label:"Reported items",desc:"Possible values: Infected, HardErrors, SoftErrors, OK, Skipped. Values are separated by semicolon (e.g. OK;Skipped). There may be also values Start and Stop but they have no effect.",path:{name:"avcfg://***ProviderINI***/Common/ReportRecords",objectId:"EmailShield"},type:"text"},{label:"SMTP port(s)",desc:"Separate multiple values with a comma.",path:"avcfg://EmailShield/EmailScanner/SmtpRedirectPort",type:"text"},{label:"SMTP secure port(s)",desc:"Separate multiple values with a comma.",path:"avcfg://EmailShield/EmailScanner/SmtpRedirectPortSSL",type:"text"},{label:"POP port(s)",desc:"Separate multiple values with a comma.",path:"avcfg://EmailShield/EmailScanner/PopRedirectPort",type:"text"},{label:"POP secure port(s)",desc:"Separate multiple values with a comma.",path:"avcfg://EmailShield/EmailScanner/PopRedirectPortSSL",type:"text"},{label:"IMAP port(s)",desc:"Separate multiple values with a comma.",path:"avcfg://EmailShield/EmailScanner/ImapRedirectPort",type:"text"},{label:"IMAP secure port(s)",desc:"Separate multiple values with a comma.",path:"avcfg://EmailShield/EmailScanner/ImapRedirectPortSSL",type:"text"},{label:"NNTP port(s)",desc:"Separate multiple values with a comma.",path:"avcfg://EmailShield/EmailScanner/NntpRedirectPort",type:"text"},{label:"NNTP secure port(s)",desc:"Separate multiple values with a comma.",path:"avcfg://EmailShield/EmailScanner/NntpRedirectPortSSL",type:"text"},{label:"Ignored addresses",desc:"Separate multiple values with a comma.",path:"avcfg://EmailShield/EmailScanner/IgnoreAddress",type:"text"},{label:"Ignore local communication",path:"avcfg://EmailShield/EmailScanner/IgnoreLocalhost",type:"checkbox"}]},Tn={id:"webShield",titleId:"shields.web",componentId:"ais_shl_web",loadProps:()=>[{label:"Action to be performed when a virus is found",path:{name:"avcfg://***ProviderINI***/Common/VirusAction",objectId:"WebShield"},type:"select",options:[{label:"Abort connection",value:"abort"},{label:"Ask",value:"interactive"}]},{label:"Action to be performed when a potentially unwanted program is found",path:{name:"avcfg://***ProviderINI***/Common/PUPAction",objectId:"WebShield"},type:"select",options:[{label:"Abort connection",value:"abort"},{label:"Ask",value:"interactive"}]},{label:"Action to be performed when a potentially unwanted tool is found",path:{name:"avcfg://***ProviderINI***/Common/ToolAction",objectId:"WebShield"},type:"select",options:[{label:"Abort connection",value:"abort"},{label:"Ask",value:"interactive"}]},{label:"Action to be performed when a suspicious object is found",path:{name:"avcfg://***ProviderINI***/Common/SuspiciousAction",objectId:"WebShield"},type:"select",options:[{label:"Abort connection",value:"abort"},{label:"Ask",value:"interactive"}]},{label:"Scan traffic from well-known browser process only",path:{name:"avcfg://WebShield/WebScanner/ScanOnlyBrowsers"},type:"checkbox"},{label:"Show a notification window when action is taken",path:{name:"avcfg://***ProviderINI***/Common/ShowAppliedActionNotification",objectId:"WebShield"},type:"checkbox"},{label:"Protect Internet Explorer with Script Shield",path:"avcfg://ScriptShield/Common/InternetExplorer",type:"checkbox"},{label:"Protect Mozilla Firefox with Script Shield",path:"avcfg://ScriptShield/Common/MozillaFirefox",type:"checkbox"},{label:"Protect Google Chrome with Script Shield",path:"avcfg://ScriptShield/Common/GoogleChrome",type:"checkbox"},{label:"Protect Adobe Acrobat Reader with Script Shield",path:"avcfg://ScriptShield/Common/AdobeAcrobatReader",type:"checkbox"},{label:"Protect other applications with Script Shield",path:"avcfg://ScriptShield/Common/OtherApplications",type:"checkbox"},{label:"Report file name",path:{name:"avcfg://***ProviderINI***/Common/ReportName",objectId:"WebShield"},type:"text"},{label:"Report file type",path:{name:"avcfg://***ProviderINI***/Common/Report",objectId:"WebShield"},type:"select",options:[{label:"Plain text (ANSI)",value:"TXT"},{label:"Plain text (Unicode)",value:"UTXT"},{label:"XML",value:"XML"}]},{label:"If report file exists",path:{name:"avcfg://***ProviderINI***/Common/OverwriteReport",objectId:"WebShield"},type:"select",options:[{label:"Append",value:"0"},{label:"Overwrite",value:"1"}]},{label:"Reported items",desc:"Possible values: Infected, HardErrors, SoftErrors, OK, Skipped. Values are separated by semicolon (e.g. OK;Skipped). There may be also values Start and Stop but they have no effect.",path:{name:"avcfg://***ProviderINI***/Common/ReportRecords",objectId:"WebShield"},type:"text"}]};function En(e){let t,n;return t=new ae({props:{config:e[2],windowClose:e[0].close.action,$$slots:{default:[_n]},$$scope:{ctx:e}}}),{c(){P(t.$$.fragment)},m(e,i){_(t,e,i),n=!0},p(e,n){const i={};4&n&&(i.config=e[2]),1&n&&(i.windowClose=e[0].close.action),67108874&n&&(i.$$scope={dirty:n,ctx:e}),t.$set(i)},i(e){n||(r(t.$$.fragment,e),n=!0)},o(e){o(t.$$.fragment,e),n=!1},d(e){D(t,e)}}}function Pn(e){let t,n,l,s,o;return{c(){t=u("kin-input"),n=i(),l=u("kin-input"),b(t,"size","large"),b(t,"formrow",""),b(t,"label",K("detection.cyberCapture.addDetails.url.title")+" ("+K("global.optional")+")"),b(t,"placeholder",K("detection.cyberCapture.addDetails.url.placeholder")),b(l,"type","textarea"),b(l,"formrow",""),b(l,"size","large"),b(l,"label",K("detection.cyberCapture.addDetails.info.title")+" ("+K("global.optional")+")"),b(l,"placeholder",K("detection.cyberCapture.addDetails.info.placeholder"))},m(i,c){a(i,t,c),a(i,n,c),a(i,l,c),s||(o=[m(t,"input",e[5]),L(On.call(null,t)),m(l,"input",e[6])],s=!0)},p:g,d(e){e&&d(t),e&&d(n),e&&d(l),s=!1,E(o)}}}function _n(e){let t,n=e[3]&&Pn(e);return{c(){n&&n.c(),t=l()},m(e,i){n&&n.m(e,i),a(e,t,i)},p(e,i){e[3]?n?n.p(e,i):(n=Pn(e),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(e){n&&n.d(e),e&&d(t)}}}function Dn(e){let t,n,i=e[2]&&En(e);return{c(){i&&i.c(),t=l()},m(e,l){i&&i.m(e,l),a(e,t,l),n=!0},p(e,[n]){e[2]?i?(i.p(e,n),4&n&&r(i,1)):(i=En(e),i.c(),r(i,1),i.m(t.parentNode,t)):i&&(s(),o(i,1,1,(()=>{i=null})),c())},i(e){n||(r(i),n=!0)},o(e){o(i),n=!1},d(e){i&&i.d(e),e&&d(t)}}}function On(e){e.focus()}function Fn(e,t,n){const i={scanning:"scanning",scanned:"scanned",resolved:"resolved",movedToChest:"movedToChest",deleted:"deleted",sentForAnalysis:"sentForAnalysis",analysed:"analysed",error:"error"},l=[i.resolved,i.movedToChest,i.deleted,i.error],a={close:{label:K("global.close"),labelTracking:"close",labelTest:"btn_close",countdown:30},confirmOpenAnyway:{label:K("detection.cyberCapture.action.openAnyway"),action:()=>Promise.resolve({color:"white",icon:{name:"icon-m-scan-file",color:"white"},title:K("detection.cyberCapture.openAnyway.title"),text:K("detection.cyberCapture.openAnyway.desc",o.fileName),actions:[a.keepBlocking,a.openAnyway],details:r,trackerTitle:"openAnywayConfirmation"}),labelTracking:"confirmOpenAnyway",labelTest:"btn_confirmOpenAnyway"},openAnyway:{label:K("detection.cyberCapture.action.openAnyway"),action:()=>G("app.av.detections.UserChoice",{id:s,userChoice:"open"}).catch((e=>{console.error("CyberCapture: opening the file failed",e)})),labelTracking:"openAnyway",labelTest:"btn_openAnyway"},keepBlocking:{label:K("detection.action.keepBlocking"),labelTracking:"keepBlocking",labelTest:"btn_keepBlocking"},goToFile:{label:K("global.goToFile"),action(){const e=o.filePath.substring(0,o.filePath.lastIndexOf("\\"));return G("app.utils.BrowseFolder",e)},labelTracking:"goToFile",labelTest:"btn_goToFile"},openChest:{label:K("viruschest.open"),action:()=>Y.openMainWindow({route:"virusChest"}),labelTracking:"openChest",labelTest:"btn_openChest"},resolve:{label:K("global.resolve"),action:y.bind(null,"resolve"),labelTracking:"resolve",labelTest:"btn_resolve"},moveToChest:{label:K("detection.action.chest"),action:y.bind(null,"moveToChest"),labelTracking:"moveToChest",labelTest:"btn_moveToChest"},delete:{label:K("global.delete"),action:y.bind(null,"delete"),labelTracking:"delete",labelTest:"btn_delete"},sendForAnalysis:{label:K("detection.cyberCapture.action.sendForAnalysis"),minDuration:1e3,action:()=>(n(2,p.progress=!0,p),new Promise((e=>{d=function(){e({color:"white",icon:{name:"icon-m-scan-file",color:"white"},title:K("detection.cyberCapture.sentForAnalysis.manually.title"),text:K("detection.cyberCapture.sentForAnalysis.manually.desc",o.fileName),actions:[a.addDetails,a.close],details:r,trackerTitle:"manuallySentForAnalysis"})},G("app.av.detections.UserChoice",{id:s,userChoice:"sendForAnalysis"})}))),labelTracking:"sendForAnalysis",labelTest:"btn_sendForAnalysis"},addDetails:{label:K("global.addDetails"),action:()=>(n(3,u=!0),Promise.resolve({color:"white",title:K("detection.cyberCapture.addDetails.title"),actions:[a.sendDetails,a.close],trackerTitle:"addDetails"})),labelTracking:"addDetails",labelTest:"btn_addDetails"},sendDetails:{label:K("global.add"),action(){const e={programName:o.filePath,description:c.info,url:c.url};return n(3,u=!1),G("app.detections.cyber_capture_send_details",e).catch((()=>{})).then((()=>({color:"green",icon:{name:"icon-m-scan-file",color:"ok"},title:K("detection.cyberCapture.addDetails.thankYou"),actions:[a.close],trackerTitle:"thanksForDetails"})))},labelTracking:"sendDetails",labelTest:"btn_sendDetails"}},s=Y.getUrlParams().id,o={},c={};let r,d,p=null,u=!1,h=!1,b=60,m=null,g=!1;function f(e){e.id===s&&(e.state===i.scanned&&(h=!0),e.filePath=e.filePath||e.path,e.fileSize=e.fileSize||e.filesize,o.filePath!==e.filePath&&(o.fileName=e.filePath.substring(e.filePath.lastIndexOf("\\")+1)),Object.assign(o,e),function(){if(r&&4===r.length)return;r=[{title:K("global.fileName"),value:oe.escapeHtml(o.fileName),testValue:"fileName"},{title:K("global.filePath"),value:oe.escapeHtml(o.filePath),testValue:"filePath"},{title:K("global.detectedBy"),value:K("cyberCapture"),testValue:"detectedBy"}],o.fileSize&&r.splice(2,0,{title:K("global.fileSize"),value:U.formatBytes(o.fileSize),testValue:"fileSize"})}(),d?(d(),d=null):function(){if(l.includes(o.state))return void n(2,p=$());n(2,p={}),n(2,p.details=r,p),n(2,p.icon={name:"icon-m-scan-file",color:"white"},p),(o.state!==i.scanning||b<=0)&&S();if(o.state===i.scanning){n(2,p.color="white",p),n(2,p.title=K("detection.cyberCapture.scanning.title"),p);let e="detection.cyberCapture.scanning.desc";g&&(e="detection.cyberCapture.scanning.desc.ask"),n(2,p.text=K(e,o.fileName),p),n(2,p.progress=!0,p),b>0&&(m=setInterval(v,1e3)),n(2,p.status={text:K("global.scanning")},p),n(2,p.trackerTitle="scanning",p)}else o.state===i.scanned&&null==o.threatDetected?(n(2,p.color="red",p),n(2,p.icon.color="critical",p),n(2,p.title=K("detection.cyberCapture.scanned.needsAnalysis.title"),p),n(2,p.text=K("detection.cyberCapture.scanned.needsAnalysis.desc",o.fileName),p),n(2,p.actions=[a.sendForAnalysis,a.moveToChest,a.confirmOpenAnyway],p),n(2,p.trackerTitle="needsAnalysis",p)):o.state!==i.scanned||o.threatDetected?o.state===i.scanned&&o.threatDetected?(n(2,p.color="red",p),n(2,p.icon.color="critical",p),n(2,p.title=K("detection.cyberCapture.scanned.threatDetected.title"),p),n(2,p.text=K("detection.cyberCapture.scanned.threatDetected.desc",o.fileName),p),n(2,p.actions=[a.resolve,a.moveToChest,a.delete],p),n(2,p.trackerTitle="threatDetected",p)):o.state===i.sentForAnalysis?(n(2,p.color="red",p),n(2,p.icon.color="critical",p),n(2,p.title=K("detection.cyberCapture.sentForAnalysis.automatically.title"),p),n(2,p.text=K("detection.cyberCapture.sentForAnalysis.automatically.desc",o.fileName),p),n(2,p.actions=[a.close,a.moveToChest,a.confirmOpenAnyway],p),n(2,p.trackerTitle="automaticallySentForAnalysis",p)):o.state!==i.analysed||o.threatDetected?o.state===i.analysed&&o.threatDetected&&(n(2,p.color="red",p),n(2,p.icon.color="critical",p),n(2,p.title=K("detection.cyberCapture.analysed.threatDetected.title"),p),n(2,p.text=K("detection.cyberCapture.analysed.threatDetected.desc",o.fileName),p),n(2,p.actions=[a.resolve,a.moveToChest,a.delete],p),n(2,p.trackerTitle="analysedThreatDetected",p)):(n(2,p.color="green",p),n(2,p.icon.color="ok",p),n(2,p.title=K("detection.cyberCapture.analysed.noThreat.title"),p),n(2,p.text=K("detection.cyberCapture.analysed.noThreat.desc",o.fileName),p),n(2,p.actions=[a.goToFile],p),n(2,p.trackerTitle="analysedNoThreat",p)):(n(2,p.color="green",p),n(2,p.icon.color="ok",p),n(2,p.title=K("detection.cyberCapture.scanned.noThreat.title"),p),n(2,p.text=K("detection.cyberCapture.scanned.noThreat.desc",o.fileName),p),n(2,p.actions=[a.close],p),n(2,p.trackerTitle="noThreat",p))}())}function S(){m=m&&clearInterval(m),n(2,p.progressStatusText=void 0,p)}function v(){b<=0&&(S(),console.warn("CyberCapture: waiting for result timed out"),Y.close()),n(2,p.progressStatusText=K("global.scanning")+" "+K("detection.aboutSecRemaining",Math.max(0,b--)),p)}function $(){let e;return o.state===i.error?(console.error("CyberCapture: resolving threat failed",o.errorCode),e={color:"white",icon:{name:"icon-m-scan-file"},title:K("detection.cyberCapture.error.title")}):e=!0===o.rebootRequired?{color:"red",icon:{name:"icon-m-scan-file",color:"critical"},title:K("scans.detection.restart.title"),text:K("scans.detection.restart.text",o.fileName),actionText:K("scans.detection.restart.actionText"),actions:[{label:K("scans.detection.restart.actionLabel"),labelTest:"btn_restart",action:()=>G("app.system.Restart",{rebootType:"RebootFromUI"}).then((()=>{Y.close()}))}],details:r}:{color:"green",icon:{name:"icon-m-scan-file",color:"ok"},title:K(h?"detection.threat.secured":"detection.cyberCapture.threatDetectedAndSecured"),text:K("detection.cyberCapture."+o.state+".desc",o.fileName),details:r},e.details=r,e.trackerTitle=o.state,!0!==o.rebootRequired&&(e.text=K("detection.cyberCapture."+o.state+".desc",o.fileName),o.state===i.movedToChest?e.actions=[a.close,a.openChest]:o.state!==i.resolved&&o.state!==i.deleted&&o.state!==i.error||(e.actions=[a.close])),e}function y(e){return new Promise((t=>{d=function(){t($())},G("app.av.detections.UserChoice",{id:s,userChoice:e})}))}H.on("app.av.detections.onStatusChanged",f),Promise.allSettled([Z.getValue("avdef://config/CyberCapture/DetectionCloseCountdown"),Z.getValue("avdef://config/CyberCapture/SyncTimeout"),Z.getValue("avcfg://avast5/Custody/AutomaticallySendForAnalysis")]).then((([e,t,i])=>{if("fulfilled"===e.status){const t=e.value;n(0,a.close.countdown=null==t?a.close.countdown:parseInt(t),a)}b=parseInt(t.value)||0,g=0===parseInt(i.value)})).then((()=>G("app.av.detections.GetStatus",{id:s}).then(f))).then((()=>Y.init({width:600,height:420})));return[a,c,p,u,!0,e=>n(1,c.url=e.target.value,c),e=>n(1,c.info=e.target.value,c)]}class Nn extends e{constructor(e){super(),t(this,e,Fn,Dn,n,{handlesWindowInit:4})}get handlesWindowInit(){return this.$$.ctx[4]}}function Rn(e){let t,n;return t=new ae({props:{config:e[0]}}),{c(){P(t.$$.fragment)},m(e,i){_(t,e,i),n=!0},p(e,n){const i={};1&n&&(i.config=e[0]),t.$set(i)},i(e){n||(r(t.$$.fragment,e),n=!0)},o(e){o(t.$$.fragment,e),n=!1},d(e){D(t,e)}}}function Wn(e){let t,n,i=e[0]&&Rn(e);return{c(){i&&i.c(),t=l()},m(e,l){i&&i.m(e,l),a(e,t,l),n=!0},p(e,[n]){e[0]?i?(i.p(e,n),1&n&&r(i,1)):(i=Rn(e),i.c(),r(i,1),i.m(t.parentNode,t)):i&&(s(),o(i,1,1,(()=>{i=null})),c())},i(e){n||(r(i),n=!0)},o(e){o(i),n=!1},d(e){i&&i.d(e),e&&d(t)}}}function jn(e){return{server:e.server_name,process:e.process_path,exclusionAllowed:e.allow_accept,cert:e.cert,certChain:e.cert_chain,certProblems:e.cert_status}}function Bn(e,t,n){const i=Y.getUrlParams().id;let l=null;function a(e){n(0,l={color:"red",icon:{name:"icon-m-scan-file",color:"critical"},title:K("detection.mailCertificate.title",e.certProblems.length),text:s(e.certProblems)+K("detection.mailCertificate.note"),actions:o(e),details:[{title:K("global.location"),value:oe.escapeHtml(e.server),testValue:"location"},{title:K("global.process"),value:oe.escapeHtml(e.process),testValue:"detectedBy"},{title:K("global.detectedBy"),value:K("shields.email"),testValue:"detectedBy"}]})}function s(e){if(!e||!e.length)return"";let t="";return e.forEach((e=>{t+=K("detection.mailCertificate.desc."+e)+"<br />"})),t+"<br />"}function o(e){const t={close:{label:K("global.close"),labelTracking:"close",labelTest:"btn_close"},confirmExclusion:{label:K("detection.mailCertificate.confirmExclusion"),action:()=>G("app.av.detections.UserChoice",{id:i,userChoice:"allow"}),labelTracking:"confirmExclusion",labelTest:"btn_confirmExclusion"},confirmExclusionAndStore:{label:K("detection.mailCertificate.confirmAndStoreExclusion"),action:()=>G("app.av.detections.UserChoice",{id:i,userChoice:"allow_and_store"}),labelTracking:"confirmExclusionAndStore",labelTest:"btn_confirmExclusionAndStore"},viewCertificate:{label:K("detection.mailCertificate.viewCertificate"),action:()=>(G("app.utils.ViewCertificate",{cert:e.cert,cert_chain:e.certChain}),Promise.resolve(l)),labelTracking:"viewCertificate",labelTest:"btn_viewCertificate"}};return e.exclusionAllowed?[t.confirmExclusion,t.confirmExclusionAndStore,t.viewCertificate]:[t.close,t.viewCertificate]}return ce((()=>{G("app.av.detections.GetStatus",{id:i}).then(jn).then(a).then(Y.init)})),[l,!0]}class Mn extends e{constructor(e){super(),t(this,e,Bn,Wn,n,{handlesWindowInit:1})}get handlesWindowInit(){return this.$$.ctx[1]}}function Vn(e){let t,n;return t=new ae({props:{config:e[0]}}),{c(){P(t.$$.fragment)},m(e,i){_(t,e,i),n=!0},p(e,n){const i={};1&n&&(i.config=e[0]),t.$set(i)},i(e){n||(r(t.$$.fragment,e),n=!0)},o(e){o(t.$$.fragment,e),n=!1},d(e){D(t,e)}}}function Ln(e){let t,n,i=e[0]&&Vn(e);return{c(){i&&i.c(),t=l()},m(e,l){i&&i.m(e,l),a(e,t,l),n=!0},p(e,[n]){e[0]?i?(i.p(e,n),1&n&&r(i,1)):(i=Vn(e),i.c(),r(i,1),i.m(t.parentNode,t)):i&&(s(),o(i,1,1,(()=>{i=null})),c())},i(e){n||(r(i),n=!0)},o(e){o(i),n=!1},d(e){i&&i.d(e),e&&d(t)}}}function Kn(e){return{url:e.url,certName:e.cert_name,issuerName:e.issuer_name,blockReason:e.block_reason}}function Un(e,t,n){const i={CERT_BLOCK_INVALID:1,CERT_BLOCK_REVOKED:2,CERT_BLOCK_EXPIRED_CA:3,CERT_BLOCK_CERTREP:4,CERT_BLOCK_SSL2:5,CERT_BLOCK_SSL3:6,CERT_BLOCK_KEY_EXCHANGE:7},l=Y.getUrlParams().id;let a=null;function s(e,t){switch(e){case i.CERT_BLOCK_INVALID:return K("detection.certificate.invalid",t);case i.CERT_BLOCK_REVOKED:return K("detection.certificate.revoked",t);case i.CERT_BLOCK_EXPIRED_CA:return K("detection.certificate.expired",t);case i.CERT_BLOCK_CERTREP:return K("detection.certificate.certrep",t);case i.CERT_BLOCK_SSL2:return K("detection.certificate.ssl",t,"SSL2");case i.CERT_BLOCK_SSL3:return K("detection.certificate.ssl",t,"SSL3");case i.CERT_BLOCK_KEY_EXCHANGE:return K("detection.certificate.keyexchange",t)}}function o(e){n(0,a={color:"red",icon:{name:"circle-critical"},title:K("detection.certificate.title"),text:s(e.blockReason,e.url),actions:[{label:K("global.close"),labelTracking:"close",labelTest:"btn_close"}],details:[{title:K("detection.certificate.certname"),value:oe.escapeHtml(e.certName),testValue:"certname"},{title:K("detection.certificate.issuer"),value:oe.escapeHtml(e.issuerName),testValue:"issuer"},{title:K("global.detectedBy"),value:K("shields.web"),testValue:"detectedBy"}]})}return ce((()=>{G("app.av.detections.GetStatus",{id:l}).then(Kn).then(o).then(Y.init)})),[a,!0]}class Hn extends e{constructor(e){super(),t(this,e,Un,Ln,n,{handlesWindowInit:1})}get handlesWindowInit(){return this.$$.ctx[1]}}function zn(e){let t,n;return t=new ae({props:{config:e[0]}}),{c(){P(t.$$.fragment)},m(e,i){_(t,e,i),n=!0},p(e,n){const i={};1&n&&(i.config=e[0]),t.$set(i)},i(e){n||(r(t.$$.fragment,e),n=!0)},o(e){o(t.$$.fragment,e),n=!1},d(e){D(t,e)}}}function Gn(e){let t,n,i=e[0]&&zn(e);return{c(){i&&i.c(),t=l()},m(e,l){i&&i.m(e,l),a(e,t,l),n=!0},p(e,[n]){e[0]?i?(i.p(e,n),1&n&&r(i,1)):(i=zn(e),i.c(),r(i,1),i.m(t.parentNode,t)):i&&(s(),o(i,1,1,(()=>{i=null})),c())},i(e){n||(r(i),n=!0)},o(e){o(i),n=!1},d(e){i&&i.d(e),e&&d(t)}}}const Xn=500;function qn(e,t,n){const i=Y.getUrlParams().id;let l=null,a={};function s(){return G("app.av.detections.UserChoice",{id:i,userChoice:"ignore"}).catch((()=>{})).then((()=>({color:"green",icon:{name:"icon-m-app",color:"ok"},title:K("detection.threat.exception"),text:K("detection.exception.text",a.name),actionText:K("scans.antirootkit.detection.rootkit.movedToExceptionList.actionText",1),actions:[{label:K("global.gotIt"),labelTest:"global.gotIt",labelTracking:"gotIt"}],details:c(a),status:{text:K("detection.threat.exception.moved"),actionLabel:K("detection.threat.exception.openList"),action:o}})))}function o(){return G("app.windowManager.ShowMainWindow",{route:"#settings/exceptions"}).catch((()=>{}))}function c(e){return[{title:K("global.process"),value:e.process,testValue:"process"},{title:K("detection.path"),value:e.file,testValue:"filename"},{title:K("global.detectedBy"),value:"Hardened Domain Reputation",testValue:"detectedBy"}]}return G("app.av.detections.GetStatus",{id:i}).then((function(e){const t=oe.escapeHtml(e.process||"");return a={process:t,file:oe.escapeHtml(e.file),name:t.split(/\/|\\/g).pop()},a})).then((function(e){n(0,l={color:"red",icon:{name:"icon-m-app-warning",color:"neutral"},title:K("detection.hardenedMode.title",e.name),text:"Reputation system prevented a malicious program from starting on your computer.",actionText:"If you are sure the program is safe and you still want to run it, please use the Add Exception button below.",actions:[{label:K("global.close"),labelTracking:"close",labelTest:"btn_close"},{label:K("settings.exceptions.addException"),labelTracking:"addException",labelTest:"btn_addException",action:s,minDuration:Xn,status:{text:K("detection.action.exception.progress")}}],status:{text:K("detection.status.block")},details:c(e)})})).then(Y.init),[l,!0]}class Yn extends e{constructor(e){super(),t(this,e,qn,Gn,n,{handlesWindowInit:1})}get handlesWindowInit(){return this.$$.ctx[1]}}function Jn(e){let t,n;return t=new ae({props:{config:e[0]}}),{c(){P(t.$$.fragment)},m(e,i){_(t,e,i),n=!0},p(e,n){const i={};1&n&&(i.config=e[0]),t.$set(i)},i(e){n||(r(t.$$.fragment,e),n=!0)},o(e){o(t.$$.fragment,e),n=!1},d(e){D(t,e)}}}function Qn(e){let t,n,i=e[0]&&Jn(e);return{c(){i&&i.c(),t=l()},m(e,l){i&&i.m(e,l),a(e,t,l),n=!0},p(e,[n]){e[0]?i?(i.p(e,n),1&n&&r(i,1)):(i=Jn(e),i.c(),r(i,1),i.m(t.parentNode,t)):i&&(s(),o(i,1,1,(()=>{i=null})),c())},i(e){n||(r(i),n=!0)},o(e){o(i),n=!1},d(e){i&&i.d(e),e&&d(t)}}}const Zn=500;function ei(e,t,n){const i=Y.getUrlParams().id;let l=null,a={};function s(){return G("app.av.detections.UserChoice",{id:i,userChoice:"ignore"}).catch((()=>{})).then((()=>({color:"green",icon:{name:"icon-m-app",color:"ok"},title:K("detection.threat.exception"),text:K("detection.exception.text",a.name),actionText:K("scans.antirootkit.detection.rootkit.movedToExceptionList.actionText",1),actions:[{label:K("global.gotIt"),labelTest:"global.gotIt",labelTracking:"gotIt"}],details:c(a.file),status:{text:K("detection.threat.exception.moved"),actionLabel:K("detection.threat.exception.openList"),action:o}})))}function o(){return G("app.windowManager.ShowMainWindow",{route:"#settings/exceptions"}).catch((()=>{}))}function c(e){return[{title:K("detection.path"),value:e,testValue:"filename"},{title:K("global.detectedBy"),value:K("detection.hardenedMode"),testValue:"detectedBy"}]}return G("app.av.detections.GetStatus",{id:i}).then((function(e){const t=oe.escapeHtml(e.file||"");return a={file:t,name:t.split(/\/|\\/g).pop()},a})).then((function(e){n(0,l={color:"red",icon:{name:"icon-m-app-warning",color:"neutral"},title:K("detection.hardenedMode.title",e.name),text:K("detection.hardenedMode.desc"),actionText:K("detection.hardenedMode.action.desc"),actions:[{label:K("global.close"),labelTracking:"close",labelTest:"btn_close"},{label:K("settings.exceptions.addException"),labelTracking:"addException",labelTest:"btn_addException",action:s,minDuration:Zn,status:{text:K("detection.action.exception.progress")}}],status:{text:K("detection.status.block")},details:c(e.file)})})).then(Y.init),[l,!0]}class ti extends e{constructor(e){super(),t(this,e,ei,Qn,n,{handlesWindowInit:1})}get handlesWindowInit(){return this.$$.ctx[1]}}class ni extends Ge{constructor(e){e.props=e.props||{},e.props.standalone=!0,super(e)}}class ii extends et{constructor(e){e.props=e.props||{},e.props.standalone=!0,super(e)}}class li extends ut{constructor(e){e.props=e.props||{},e.props.standalone=!0,super(e)}}class ai extends jt{constructor(e){e.props=e.props||{},e.props.standalone=!0,super(e)}}class si extends gn{constructor(e){e.props=e.props||{},e.props.shieldsSeparately=!0,super(e)}}const oi=function(e){return{title:Qt.title,desc:Qt.desc,items:cn(e)}}.bind(null,!0),ci=He.bind(null,!0),ri=Qe.bind(null,!0),di=dt.bind(null,!0),pi=Rt.bind(null,!0),ui=[fn,Cn,xn,Tn];export{ni as behaviorShieldSettings,ci as behaviorShieldSettingsSearchStrings,Hn as certificateDetection,Nn as cyberCaptureDetection,ii as fileShieldSettings,ri as fileShieldSettingsSearchStrings,Yn as hardenedDomainRepDetection,ti as hardenedModeDetection,Mn as mailCertificateDetection,li as mailShieldSettings,di as mailShieldSettingsSearchStrings,si as settings,ui as settingsGeek,oi as settingsSearchStrings,ai as webShieldSettings,pi as webShieldSettingsSearchStrings};const hi={name:"shields",version:"1.2.1298",created:"2023-07-13T10:35:45.654Z"};export{hi as metadata};
